<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 1 ï¼šå¯†ç åŠ å¯†é‚£äº›äº‹å„¿</title>
    <url>/2024/11/15/2024-11-15-password-security/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ˜¯æˆ‘åšçš„ç¬¬ä¸€ä¸ªé¡¹ç›®ã€‚å‰å‡ å¤©æˆ‘å¯¹å®‰å…¨çš„ç†è§£åªåœç•™åœ¨â€œåˆ«å†™å‡º bug å°±è¡Œâ€ã€‚ç›´åˆ°åœ¨æµ‹è¯•æ•°æ®åº“æ—¶ï¼Œäº²çœ¼çœ‹åˆ° <code>user_password</code> å­—æ®µé‡Œèººç€ä¸€ä¸²ä¸²æ˜æ–‡å¯†ç ï¼Œæ‰æƒ³èµ·ä¹‹å‰åˆ·åˆ°çš„è§†é¢‘é‡Œä¸€å¥è¯ï¼šâ€œæ˜æ–‡å¯†ç  &#x3D; çº¢çº¿â€ã€‚æœ¬æ–‡è®°å½•æˆ‘ä»æ˜æ–‡å­˜å‚¨åˆ°ä½¿ç”¨ BCrypt çš„å…¨è¿‡ç¨‹ï¼Œç•™ç»™ä¹Ÿåœ¨è‹¦è‹¦å†™é¡¹ç›®çš„åŒå­¦åšå‚è€ƒã€‚</p>
<h2 id="é—®é¢˜çˆ†å‘ï¼šæ•°æ®åº“é‡Œçš„â€œè£¸å¥”â€å¯†ç "><a href="#é—®é¢˜çˆ†å‘ï¼šæ•°æ®åº“é‡Œçš„â€œè£¸å¥”â€å¯†ç " class="headerlink" title="é—®é¢˜çˆ†å‘ï¼šæ•°æ®åº“é‡Œçš„â€œè£¸å¥”â€å¯†ç "></a>é—®é¢˜çˆ†å‘ï¼šæ•°æ®åº“é‡Œçš„â€œè£¸å¥”â€å¯†ç </h2><p>é¡¹ç›®åˆæœŸæˆ‘åªæƒ³å…ˆè·‘é€šæµç¨‹ï¼Œç›´æ¥æŠŠå‰ç«¯ä¼ æ¥çš„å¯†ç ä¸¢è¿›æ•°æ®åº“ã€‚æ§åˆ¶å±‚ä»£ç å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯ç¤ºèŒƒï¼Œè¯·å‹¿æ¨¡ä»¿</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">register</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (user.getPassword().length() &lt; <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(<span class="string">&quot;å¯†ç é•¿åº¦ä¸è¶³&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    userMapper.insert(user); <span class="comment">// ç›´æ¥å­˜æ˜æ–‡</span></span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ç”¨ Navicat æ‰“å¼€æ•°æ®è¡¨ï¼Œ<code>&quot;12345678&quot;</code>ã€<code>&quot;abcdefg&quot;</code> ç­‰å¼±å¯†ç å…¨åœ¨é‡Œé¢ã€‚æ­¤åˆ»æˆ‘æ‰æ„è¯†åˆ°ï¼šå¦‚æœæ•°æ®åº“è¢«æ‹–åº“ï¼Œæ‰€æœ‰ç”¨æˆ·è´¦å·éƒ½ä¼šæš´éœ²ã€‚</p>
<h2 id="è§£å†³è¿‡ç¨‹ï¼šBCrypt-çš„æ•‘èµ"><a href="#è§£å†³è¿‡ç¨‹ï¼šBCrypt-çš„æ•‘èµ" class="headerlink" title="è§£å†³è¿‡ç¨‹ï¼šBCrypt çš„æ•‘èµ"></a>è§£å†³è¿‡ç¨‹ï¼šBCrypt çš„æ•‘èµ</h2><h3 id="1-é€‰å‹"><a href="#1-é€‰å‹" class="headerlink" title="1. é€‰å‹"></a>1. é€‰å‹</h3><p>æŸ¥èµ„æ–™åé”å®šå‡ ä¸ªå¸¸è§æ–¹æ¡ˆï¼š</p>
<ul>
<li><code>MD5</code>ï¼šä¸å¯é€†ï¼Œä½†å½©è™¹è¡¨å’Œ GPU æš´åŠ›ç ´è§£å¤ªå¿«ï¼›</li>
<li><code>SHA</code>ï¼šåŒæ ·å±äºå¿«é€Ÿå“ˆå¸Œï¼Œå¯¹å¯†ç ä¿æŠ¤ä¸å¤Ÿï¼›</li>
<li><code>BCrypt</code>ï¼šè‡ªå¸¦ç›å€¼ï¼Œè®¡ç®—æ…¢ï¼Œå¯æ‹–æ…¢æš´åŠ›ç ´è§£ã€‚</li>
</ul>
<p>ç»“åˆ Spring ç”Ÿæ€ï¼Œæˆ‘ç›´æ¥ä½¿ç”¨ <code>BCryptPasswordEncoder</code>ï¼Œä¸å¿…è‡ªå·±ç»´æŠ¤ç›å€¼ï¼Œæ•´åˆä¹Ÿå¾ˆé¡ºã€‚</p>
<h3 id="2-ä»£ç æ”¹é€ "><a href="#2-ä»£ç æ”¹é€ " class="headerlink" title="2. ä»£ç æ”¹é€ "></a>2. ä»£ç æ”¹é€ </h3><p><strong>å¼•å…¥ä¾èµ–</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>æ³¨å†ŒåŠ å¯† Bean</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecurityConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> PasswordEncoder <span class="title function_">passwordEncoder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ”¹é€ æ³¨å†Œ &#x2F; ç™»å½•é€»è¾‘</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PasswordEncoder passwordEncoder;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encodedPassword</span> <span class="operator">=</span> passwordEncoder.encode(user.getPassword());</span><br><span class="line">        user.setPassword(encodedPassword);</span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">login</span><span class="params">(String account, String password)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectByAccount(account);</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!passwordEncoder.matches(password, user.getPassword())) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-æ–°å‘ï¼šå­—æ®µé•¿åº¦ä¸å¤Ÿ"><a href="#3-æ–°å‘ï¼šå­—æ®µé•¿åº¦ä¸å¤Ÿ" class="headerlink" title="3. æ–°å‘ï¼šå­—æ®µé•¿åº¦ä¸å¤Ÿ"></a>3. æ–°å‘ï¼šå­—æ®µé•¿åº¦ä¸å¤Ÿ</h3><p>BCrypt ç”Ÿæˆçš„å“ˆå¸Œå¤§çº¦ 60 ä¸ªå­—ç¬¦ï¼Œè€Œæˆ‘çš„ <code>user_password</code> æ˜¯ <code>varchar(50)</code>ã€‚æ’å…¥æ—¶æŠ¥é”™ï¼Œåªèƒ½èµ¶ç´§è¿è¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> <span class="keyword">user</span></span><br><span class="line">MODIFY <span class="keyword">COLUMN</span> user_password <span class="type">VARCHAR</span>(<span class="number">60</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;å¯†ç å“ˆå¸Œ&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™æ¬¡è¸©å‘çš„æ”¶è·ï¼š</p>
<ul>
<li>æ˜æ–‡å¯†ç ç»å¯¹ä¸èƒ½å…¥åº“ï¼ŒBCrypt æ˜¯ä¸Šæ‰‹å‹å¥½çš„æ–¹æ¡ˆï¼›</li>
<li>å“ˆå¸Œå­—ç¬¦ä¸²ä¼šæ›´é•¿ï¼Œåº“è¡¨å­—æ®µè¦é¢„ç•™ç©ºé—´ï¼›</li>
<li>å–„ç”¨æ¡†æ¶æä¾›çš„å·¥å…·ï¼Œåˆ«é‡å¤é€ è½®å­ã€‚</li>
</ul>
<p>ä¸‹ä¸€ç¯‡æˆ‘åº”è¯¥è¿˜ä¼šè®°å½•åœ¨è¿™ä¸ªé¡¹ç›®é‡åˆ°çš„å…¶ä»–é—®é¢˜ï¼Œå¸Œæœ›è¿˜èƒ½åšæŒå†™ä¸‹å»ï¼Œæ¬¢è¿å‚¬æ›´ï¼</p>
<hr>
<h2 id="æ›´æ–°-â€“-ç›¸å…³æ–‡ç« "><a href="#æ›´æ–°-â€“-ç›¸å…³æ–‡ç« " class="headerlink" title="æ›´æ–° â€“ ç›¸å…³æ–‡ç« "></a>æ›´æ–° â€“ ç›¸å…³æ–‡ç« </h2><p>è¿™ä¸ªç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ç³»åˆ—çš„å…¶ä»–æ–‡ç« ï¼š</p>
<ul>
<li><a href="/2024/11/20/2024-11-20-login-session/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 2ï¼šç™»å½•æ€ç®¡ç†çš„é‚£äº›å‘</a></li>
<li><a href="/2024/11/26/2024-11-26-user-center-database-design/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®çš„æ•°æ®åº“è®¾è®¡ï¼šå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="/2024/11/29/2024-11-29-user-center-project-summary/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®æ€»ç»“ï¼šä» 0 åˆ° 1 çš„å®Œæ•´å®è·µ</a></li>
</ul>
]]></content>
      <categories>
        <category>Debug ç»éªŒ</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
        <tag>BCrypt</tag>
        <tag>Spring Boot</tag>
        <tag>ç”¨æˆ·ä¸­å¿ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>åšå®¢å¼€å¼ ï¼šè®°å½•æˆ‘çš„åç«¯å¼€å‘çš„æ€è€ƒä¸æˆé•¿</title>
    <url>/2024/11/03/2024-11-03-my-first-blog-post/</url>
    <content><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>ä»Šå¤©æ˜¯æˆ‘å¼€å§‹å†™åšå®¢çš„ç¬¬ä¸€å¤©ï¼ˆç»ˆäºä¸‹å®šå†³å¿ƒäº†ï¼ï¼‰ã€‚ä½œä¸ºä¸€ååç«¯å¼€å‘å­¦ä¹ è€…ï¼Œæˆ‘å†³å®šç”¨è¿™ä¸ªåšå®¢è®°å½•æˆ‘åœ¨å¼€å‘è¿‡ç¨‹ä¸­çš„æ€è€ƒã€è¸©è¿‡çš„å‘ä»¥åŠæ”¶è·ã€‚è™½ç„¶ä¸çŸ¥é“èƒ½åšæŒå¤šä¹…ï¼Œä½†è‡³å°‘å…ˆå¼€å§‹å§ ğŸ˜…</p>
<h2 id="ä¸ºä»€ä¹ˆè¦å†™åšå®¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦å†™åšå®¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å†™åšå®¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦å†™åšå®¢ï¼Ÿ</h2><ol>
<li><strong>çŸ¥è¯†æ²‰æ·€</strong>ï¼šæŠŠé›¶æ•£çš„çŸ¥è¯†ç‚¹æ•´ç†æˆä½“ç³»åŒ–çš„æ–‡ç« </li>
<li><strong>é—®é¢˜å¤ç›˜</strong>ï¼šè®°å½•debugè¿‡ç¨‹ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜èƒ½å¿«é€Ÿå®šä½</li>
<li><strong>æŠ€æœ¯æˆé•¿</strong>ï¼šé€šè¿‡å†™ä½œåŠ æ·±å¯¹æŠ€æœ¯çš„ç†è§£</li>
<li><strong>åˆ†äº«äº¤æµ</strong>ï¼šå¸Œæœ›èƒ½å¸®åŠ©åˆ°é‡åˆ°åŒæ ·é—®é¢˜çš„å¼€å‘è€…</li>
</ol>
<h2 id="åšå®¢å†…å®¹è§„åˆ’"><a href="#åšå®¢å†…å®¹è§„åˆ’" class="headerlink" title="åšå®¢å†…å®¹è§„åˆ’"></a>åšå®¢å†…å®¹è§„åˆ’</h2><p>è¿™ä¸ªåšå®¢ä¸»è¦ä¼šè®°å½•ï¼š</p>
<ul>
<li><strong>åç«¯å¼€å‘æ€è€ƒ</strong>ï¼šæ¶æ„è®¾è®¡ã€æ€§èƒ½ä¼˜åŒ–ã€ä»£ç è´¨é‡ç­‰</li>
<li><strong>Debugç»éªŒ</strong>ï¼šå®é™…é¡¹ç›®ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</li>
<li><strong>æŠ€æœ¯å­¦ä¹ </strong>ï¼šå­¦ä¹ æ–°æŠ€æœ¯çš„å¿ƒå¾—å’Œæ€»ç»“</li>
<li><strong>è¸©å‘è®°å½•</strong>ï¼šé‚£äº›è®©äººå¤´ç–¼çš„bugå’Œè§£å†³æ–¹æ¡ˆ</li>
</ul>
<h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>å¸Œæœ›è¿™ä¸ªåšå®¢èƒ½è§è¯æˆ‘çš„æŠ€æœ¯æˆé•¿ï¼Œä¹Ÿå¸Œæœ›èƒ½ä¸ºå…¶ä»–å¼€å‘è€…æä¾›ä¸€äº›å‚è€ƒï¼ˆè™½ç„¶ç°åœ¨è¿˜æ˜¯ä¸ªèœé¸Ÿå“ˆå“ˆå“ˆï¼‰ã€‚</p>
<p>è·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ã€‚</p>
<p>PS: å¦‚æœæ–‡ç« æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ï¼æ¯•ç«Ÿè¿˜åœ¨å­¦ä¹ ä¸­ï¼Œéš¾å…ä¼šæœ‰ç†è§£ä¸åˆ°ä½çš„åœ°æ–¹ ğŸ˜Š</p>
]]></content>
      <categories>
        <category>éšä¾¿è¯´è¯´</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
        <tag>éšç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»é›¶å¼€å§‹æ­å»ºä¸ªäººåšå®¢ï¼šHexo + Butterfly</title>
    <url>/2024/11/21/2024-11-21-building-my-blog-with-hexo/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸€ç›´æƒ³æ­å»ºä¸€ä¸ªä¸ªäººåšå®¢ï¼Œè®°å½•è‡ªå·±çš„æŠ€æœ¯æˆé•¿å’Œæ€è€ƒï¼ˆä¸»è¦æ˜¯æƒ³æœ‰ä¸ªåœ°æ–¹è®°å½•è¸©è¿‡çš„å‘ï¼Œå…å¾—ä¸‹æ¬¡åˆå¿˜äº† ğŸ˜‚ï¼‰ã€‚ç»è¿‡ä¸€ç•ªè°ƒç ”ï¼Œæœ€ç»ˆé€‰æ‹©äº† Hexo + Butterfly ä¸»é¢˜ã€‚è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹æ­å»ºè¿‡ç¨‹å’Œä¸€äº›è¸©å‘ç»å†ï¼ˆçœŸçš„è¸©äº†å¥½å¤šå‘â€¦ï¼‰ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©-Hexoï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©-Hexoï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹© Hexoï¼Ÿ"></a>ä¸ºä»€ä¹ˆé€‰æ‹© Hexoï¼Ÿ</h2><h3 id="1-é™æ€ç«™ç‚¹ç”Ÿæˆå™¨"><a href="#1-é™æ€ç«™ç‚¹ç”Ÿæˆå™¨" class="headerlink" title="1. é™æ€ç«™ç‚¹ç”Ÿæˆå™¨"></a>1. é™æ€ç«™ç‚¹ç”Ÿæˆå™¨</h3><p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ï¼Œä½¿ç”¨ Markdown ç¼–å†™æ–‡ç« ï¼Œç„¶åç”Ÿæˆé™æ€ HTML æ–‡ä»¶ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>é€Ÿåº¦å¿«</strong>ï¼šé™æ€æ–‡ä»¶ï¼Œè®¿é—®é€Ÿåº¦å¿«</li>
<li><strong>SEOå‹å¥½</strong>ï¼šé™æ€HTMLï¼Œæœç´¢å¼•æ“å®¹æ˜“ç´¢å¼•</li>
<li><strong>å…è´¹æ‰˜ç®¡</strong>ï¼šå¯ä»¥éƒ¨ç½²åˆ° GitHub Pagesã€Netlify ç­‰å…è´¹å¹³å°</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šæ–‡ç« ç”¨ Markdown ç¼–å†™ï¼Œå¯ä»¥ç”¨ Git ç®¡ç†</li>
</ul>
<h3 id="2-ä¸°å¯Œçš„ä¸»é¢˜"><a href="#2-ä¸°å¯Œçš„ä¸»é¢˜" class="headerlink" title="2. ä¸°å¯Œçš„ä¸»é¢˜"></a>2. ä¸°å¯Œçš„ä¸»é¢˜</h3><p>Hexo æœ‰ä¸°å¯Œçš„ä¸»é¢˜ç”Ÿæ€ï¼Œæˆ‘é€‰æ‹©äº† Butterfly ä¸»é¢˜ï¼Œå› ä¸ºï¼š</p>
<ul>
<li><strong>ç•Œé¢ç¾è§‚</strong>ï¼šç°ä»£åŒ–çš„è®¾è®¡é£æ ¼</li>
<li><strong>åŠŸèƒ½ä¸°å¯Œ</strong>ï¼šæ”¯æŒä»£ç é«˜äº®ã€æœç´¢ã€è¯„è®ºç­‰</li>
<li><strong>æ–‡æ¡£å®Œå–„</strong>ï¼šä¸­æ–‡æ–‡æ¡£è¯¦ç»†ï¼Œé…ç½®ç®€å•</li>
<li><strong>æŒç»­æ›´æ–°</strong>ï¼šç¤¾åŒºæ´»è·ƒï¼Œé—®é¢˜èƒ½åŠæ—¶è§£å†³</li>
</ul>
<h2 id="æ­å»ºè¿‡ç¨‹"><a href="#æ­å»ºè¿‡ç¨‹" class="headerlink" title="æ­å»ºè¿‡ç¨‹"></a>æ­å»ºè¿‡ç¨‹</h2><h3 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… Node.jsï¼ˆéœ€è¦ 12.0 ä»¥ä¸Šç‰ˆæœ¬ï¼‰</span></span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Hexo</span></span><br><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<h3 id="2-åˆå§‹åŒ–é¡¹ç›®"><a href="#2-åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="2. åˆå§‹åŒ–é¡¹ç›®"></a>2. åˆå§‹åŒ–é¡¹ç›®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºåšå®¢ç›®å½•</span></span><br><span class="line">hexo init ahzlll.github.io</span><br><span class="line"><span class="built_in">cd</span> ahzlll.github.io</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<h3 id="3-å®‰è£…-Butterfly-ä¸»é¢˜"><a href="#3-å®‰è£…-Butterfly-ä¸»é¢˜" class="headerlink" title="3. å®‰è£… Butterfly ä¸»é¢˜"></a>3. å®‰è£… Butterfly ä¸»é¢˜</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ä¸»é¢˜</span></span><br><span class="line">git <span class="built_in">clone</span> -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…ä¸»é¢˜ä¾èµ–</span></span><br><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure>

<h3 id="4-é…ç½®ä¸»é¢˜"><a href="#4-é…ç½®ä¸»é¢˜" class="headerlink" title="4. é…ç½®ä¸»é¢˜"></a>4. é…ç½®ä¸»é¢˜</h3><p>ä¿®æ”¹ <code>_config.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç«™ç‚¹é…ç½®</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Ahzlll&#x27;s</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;åç«¯å¼€å‘æ€è€ƒ&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;ç”¨ä»£ç ç¼–ç»‡æ¢¦æƒ³ï¼Œç”¨æ–‡å­—è®°å½•æˆé•¿ï¼Œå¶å°”è®°å½•ä¸‹è¸©è¿‡çš„å‘å’Œæ”¶è·&#x27;</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Ahz</span> <span class="string">Hong</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»é¢˜é…ç½®</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">butterfly</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URLé…ç½®</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://ahzlll.github.io</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br></pre></td></tr></table></figure>

<h3 id="5-æœ¬åœ°é¢„è§ˆ"><a href="#5-æœ¬åœ°é¢„è§ˆ" class="headerlink" title="5. æœ¬åœ°é¢„è§ˆ"></a>5. æœ¬åœ°é¢„è§ˆ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨</span></span><br><span class="line">hexo server</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¿é—® http://localhost:4000</span></span><br></pre></td></tr></table></figure>

<h2 id="è¸©å‘ç»å†"><a href="#è¸©å‘ç»å†" class="headerlink" title="è¸©å‘ç»å†"></a>è¸©å‘ç»å†</h2><h3 id="1-ä¸­æ–‡è·¯å¾„é—®é¢˜"><a href="#1-ä¸­æ–‡è·¯å¾„é—®é¢˜" class="headerlink" title="1. ä¸­æ–‡è·¯å¾„é—®é¢˜"></a>1. ä¸­æ–‡è·¯å¾„é—®é¢˜</h3><p><strong>é—®é¢˜</strong>ï¼šæ–‡ç« æ ‡é¢˜åŒ…å«ä¸­æ–‡æ—¶ï¼Œç”Ÿæˆçš„URLåŒ…å«ä¸­æ–‡ï¼Œå¯èƒ½å¯¼è‡´404ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šåœ¨ <code>_config.yml</code> ä¸­é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">trailing_html:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä½¿ç”¨è‹±æ–‡æ ‡é¢˜ï¼Œåœ¨æ–‡ç« ä¸­ä½¿ç”¨ <code>title</code> å­—æ®µã€‚</p>
<h3 id="2-å›¾ç‰‡è·¯å¾„é—®é¢˜"><a href="#2-å›¾ç‰‡è·¯å¾„é—®é¢˜" class="headerlink" title="2. å›¾ç‰‡è·¯å¾„é—®é¢˜"></a>2. å›¾ç‰‡è·¯å¾„é—®é¢˜</h3><p><strong>é—®é¢˜</strong>ï¼šMarkdown ä¸­çš„å›¾ç‰‡è·¯å¾„ä¸æ­£ç¡®ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šä½¿ç”¨ Hexo çš„èµ„æºæ–‡ä»¶å¤¹åŠŸèƒ½ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨æ–‡ç« ä¸­ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">å›¾ç‰‡æè¿°</span>](<span class="link">å›¾ç‰‡åç§°.jpg</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-ä»£ç é«˜äº®é—®é¢˜"><a href="#3-ä»£ç é«˜äº®é—®é¢˜" class="headerlink" title="3. ä»£ç é«˜äº®é—®é¢˜"></a>3. ä»£ç é«˜äº®é—®é¢˜</h3><p><strong>é—®é¢˜</strong>ï¼šä»£ç é«˜äº®ä¸ç”Ÿæ•ˆã€‚</p>
<p><strong>è§£å†³</strong>ï¼šå®‰è£…ä»£ç é«˜äº®æ’ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-prism-plugin --save</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>_config.yml</code> ä¸­é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">prism_plugin:</span></span><br><span class="line">  <span class="attr">mode:</span> <span class="string">&#x27;preprocess&#x27;</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">custom_css:</span></span><br></pre></td></tr></table></figure>

<h3 id="4-æœç´¢åŠŸèƒ½"><a href="#4-æœç´¢åŠŸèƒ½" class="headerlink" title="4. æœç´¢åŠŸèƒ½"></a>4. æœç´¢åŠŸèƒ½</h3><p><strong>é—®é¢˜</strong>ï¼šæœ¬åœ°æœç´¢ä¸å·¥ä½œã€‚</p>
<p><strong>è§£å†³</strong>ï¼šå®‰è£…æœç´¢æ’ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<p>é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">xml</span></span><br></pre></td></tr></table></figure>

<h3 id="5-éƒ¨ç½²åˆ°-GitHub-Pages"><a href="#5-éƒ¨ç½²åˆ°-GitHub-Pages" class="headerlink" title="5. éƒ¨ç½²åˆ° GitHub Pages"></a>5. éƒ¨ç½²åˆ° GitHub Pages</h3><p><strong>é—®é¢˜</strong>ï¼šéƒ¨ç½²åæ ·å¼ä¸¢å¤±ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šæ£€æŸ¥ <code>_config.yml</code> ä¸­çš„ <code>url</code> é…ç½®ï¼Œç¡®ä¿ä¸ GitHub Pages åœ°å€ä¸€è‡´ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="string">https://ahzlll.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br></pre></td></tr></table></figure>

<h2 id="åšå®¢é…ç½®"><a href="#åšå®¢é…ç½®" class="headerlink" title="åšå®¢é…ç½®"></a>åšå®¢é…ç½®</h2><h3 id="1-æ·»åŠ å‹é“¾"><a href="#1-æ·»åŠ å‹é“¾" class="headerlink" title="1. æ·»åŠ å‹é“¾"></a>1. æ·»åŠ å‹é“¾</h3><p>åˆ›å»º <code>source/_data/link.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">æŠ€æœ¯åšå®¢</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">åˆ†äº«æŠ€æœ¯å¿ƒå¾—å’Œå¼€å‘ç»éªŒçš„ä¼˜ç§€åšå®¢</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Hexo</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://hexo.io/</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://hexo.io/favicon.ico</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶</span></span><br></pre></td></tr></table></figure>

<h3 id="2-è‡ªå®šä¹‰æ ·å¼"><a href="#2-è‡ªå®šä¹‰æ ·å¼" class="headerlink" title="2. è‡ªå®šä¹‰æ ·å¼"></a>2. è‡ªå®šä¹‰æ ·å¼</h3><p>åˆ›å»º <code>source/css/custom-green-theme.css</code>ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* è‡ªå®šä¹‰æ ·å¼ */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--theme-color</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸»é¢˜é…ç½®ä¸­å¼•å…¥ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom-green-theme.css&quot;&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-æ·»åŠ ç»Ÿè®¡"><a href="#3-æ·»åŠ ç»Ÿè®¡" class="headerlink" title="3. æ·»åŠ ç»Ÿè®¡"></a>3. æ·»åŠ ç»Ÿè®¡</h3><p>ä½¿ç”¨ä¸è’œå­ç»Ÿè®¡ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">site_uv:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">site_pv:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">page_pv:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="å†™ä½œä½“éªŒ"><a href="#å†™ä½œä½“éªŒ" class="headerlink" title="å†™ä½œä½“éªŒ"></a>å†™ä½œä½“éªŒ</h2><h3 id="1-Markdown-ç¼–å†™"><a href="#1-Markdown-ç¼–å†™" class="headerlink" title="1. Markdown ç¼–å†™"></a>1. Markdown ç¼–å†™</h3><p>ä½¿ç”¨ Markdown ç¼–å†™æ–‡ç« ï¼Œç®€å•é«˜æ•ˆï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: æ–‡ç« æ ‡é¢˜</span><br><span class="line">date: 2024-11-21 20:00:00</span><br><span class="line">tags:</span><br><span class="line"><span class="bullet">  -</span> æ ‡ç­¾1</span><br><span class="line"><span class="bullet">  -</span> æ ‡ç­¾2</span><br><span class="line">categories:</span><br><span class="line"><span class="section">  - åˆ†ç±»</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section">## æ ‡é¢˜</span></span><br><span class="line"></span><br><span class="line">æ­£æ–‡å†…å®¹...</span><br></pre></td></tr></table></figure>

<h3 id="2-ä»£ç é«˜äº®"><a href="#2-ä»£ç é«˜äº®" class="headerlink" title="2. ä»£ç é«˜äº®"></a>2. ä»£ç é«˜äº®</h3><p>æ”¯æŒå¤šç§è¯­è¨€çš„ä»£ç é«˜äº®ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="code">```java</span></span><br><span class="line"><span class="code">public class Hello &#123;</span></span><br><span class="line"><span class="code">    public static void main(String[] args) &#123;</span></span><br><span class="line"><span class="code">        System.out.println(&quot;Hello World&quot;);</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code">```</span></span><br></pre></td></tr></table></figure>

<h3 id="3-æ•°å­¦å…¬å¼"><a href="#3-æ•°å­¦å…¬å¼" class="headerlink" title="3. æ•°å­¦å…¬å¼"></a>3. æ•°å­¦å…¬å¼</h3><p>æ”¯æŒ LaTeX æ•°å­¦å…¬å¼ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">E = mc^2</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>

<h2 id="éƒ¨ç½²æµç¨‹"><a href="#éƒ¨ç½²æµç¨‹" class="headerlink" title="éƒ¨ç½²æµç¨‹"></a>éƒ¨ç½²æµç¨‹</h2><h3 id="1-ç”Ÿæˆé™æ€æ–‡ä»¶"><a href="#1-ç”Ÿæˆé™æ€æ–‡ä»¶" class="headerlink" title="1. ç”Ÿæˆé™æ€æ–‡ä»¶"></a>1. ç”Ÿæˆé™æ€æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure>

<h3 id="2-éƒ¨ç½²åˆ°-GitHub-Pages"><a href="#2-éƒ¨ç½²åˆ°-GitHub-Pages" class="headerlink" title="2. éƒ¨ç½²åˆ° GitHub Pages"></a>2. éƒ¨ç½²åˆ° GitHub Pages</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…éƒ¨ç½²æ’ä»¶</span></span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://github.com/ahzlll/ahzlll.github.io.git</span><br><span class="line">  branch: main</span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ¨ç½²</span></span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>

<h3 id="3-è‡ªåŠ¨åŒ–éƒ¨ç½²"><a href="#3-è‡ªåŠ¨åŒ–éƒ¨ç½²" class="headerlink" title="3. è‡ªåŠ¨åŒ–éƒ¨ç½²"></a>3. è‡ªåŠ¨åŒ–éƒ¨ç½²</h3><p>å¯ä»¥ä½¿ç”¨ GitHub Actions å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">Blog</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">source</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;16&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">hexo</span> <span class="string">generate</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">hexo</span> <span class="string">deploy</span></span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨ä½“éªŒ"><a href="#ä½¿ç”¨ä½“éªŒ" class="headerlink" title="ä½¿ç”¨ä½“éªŒ"></a>ä½¿ç”¨ä½“éªŒ</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ol>
<li><strong>å†™ä½œç®€å•</strong>ï¼šMarkdown è¯­æ³•ï¼Œä¸“æ³¨å†…å®¹</li>
<li><strong>éƒ¨ç½²æ–¹ä¾¿</strong>ï¼šä¸€é”®éƒ¨ç½²åˆ° GitHub Pages</li>
<li><strong>ä¸»é¢˜ä¸°å¯Œ</strong>ï¼šButterfly ä¸»é¢˜åŠŸèƒ½å®Œå–„</li>
<li><strong>æ€§èƒ½ä¼˜ç§€</strong>ï¼šé™æ€ç«™ç‚¹ï¼Œè®¿é—®é€Ÿåº¦å¿«</li>
<li><strong>SEOå‹å¥½</strong>ï¼šæœç´¢å¼•æ“å®¹æ˜“ç´¢å¼•</li>
</ol>
<h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ol>
<li><strong>éœ€è¦æœ¬åœ°ç¯å¢ƒ</strong>ï¼šéœ€è¦å®‰è£… Node.js</li>
<li><strong>æ›´æ–°éœ€è¦é‡æ–°ç”Ÿæˆ</strong>ï¼šæ¯æ¬¡æ›´æ–°éœ€è¦é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶</li>
<li><strong>è¯„è®ºåŠŸèƒ½</strong>ï¼šéœ€è¦ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆå¦‚ Valineã€Gitalkï¼‰</li>
</ol>
<h2 id="æœªæ¥è®¡åˆ’"><a href="#æœªæ¥è®¡åˆ’" class="headerlink" title="æœªæ¥è®¡åˆ’"></a>æœªæ¥è®¡åˆ’</h2><ol>
<li><strong>å†…å®¹ä¼˜åŒ–</strong>ï¼šæŒç»­è¾“å‡ºé«˜è´¨é‡çš„æŠ€æœ¯æ–‡ç« </li>
<li><strong>åŠŸèƒ½å®Œå–„</strong>ï¼šæ·»åŠ è¯„è®ºã€æœç´¢ç­‰åŠŸèƒ½</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šä¼˜åŒ–åŠ è½½é€Ÿåº¦ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</li>
<li><strong>SEOä¼˜åŒ–</strong>ï¼šæå‡æœç´¢å¼•æ“æ’å</li>
</ol>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ­å»ºä¸ªäººåšå®¢æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ è¿‡ç¨‹ï¼Œä¸ä»…èƒ½è®°å½•æŠ€æœ¯æˆé•¿ï¼Œè¿˜èƒ½é”»ç‚¼å†™ä½œèƒ½åŠ›ã€‚Hexo + Butterfly æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œç®€å•æ˜“ç”¨ï¼ŒåŠŸèƒ½ä¸°å¯Œã€‚</p>
<p>å¦‚æœä½ ä¹Ÿæƒ³æ­å»ºä¸ªäººåšå®¢ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„é…ç½®ï¼š</p>
<ul>
<li>åšå®¢åœ°å€ï¼š<a href="https://ahzlll.github.io/">https://ahzlll.github.io</a></li>
<li>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/ahzlll/ahzlll.github.io">https://github.com/ahzlll/ahzlll.github.io</a></li>
</ul>
<hr>
<p><strong>å†™åœ¨æœ€å</strong>ï¼šåšå®¢æ­å»ºåªæ˜¯ç¬¬ä¸€æ­¥ï¼Œæ›´é‡è¦çš„æ˜¯æŒç»­è¾“å‡ºæœ‰ä»·å€¼çš„å†…å®¹ï¼ˆè™½ç„¶ä¸çŸ¥é“èƒ½åšæŒå¤šä¹… ğŸ˜…ï¼‰ã€‚å¸Œæœ›è‡ªå·±èƒ½åšæŒä¸‹å»ï¼Œè®°å½•æŠ€æœ¯æˆé•¿ï¼Œåˆ†äº«å¼€å‘ç»éªŒã€‚å¦‚æœæ–‡ç« æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ï¼</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Butterfly</tag>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 2 ï¼šç™»å½•æ€ç®¡ç†çš„é‚£äº›å‘</title>
    <url>/2024/11/20/2024-11-20-login-session/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é¡¹ç›®åˆåˆåˆæœ‰é—®é¢˜ï¼Œæµè§ˆå™¨åˆ·æ–°ä¸€ä¸‹å°±å¾—é‡æ–°ç™»å½•ï¼Œæ‰‹æœºå’Œç”µè„‘ä¹Ÿæ— æ³•å…±äº«çŠ¶æ€ã€‚ä½œä¸ºä¸€ä¸ªå¤§äºŒå­¦ç”Ÿï¼Œåªèƒ½è¯´å®Œå…¨å°±æ˜¯å•¥ä¹Ÿä¸ä¼šï¼Œåªèƒ½ä¸€ç‚¹ç‚¹åœ°æŸ¥èµ„æ–™ã€‚æœ¬æ–‡è®°å½•æˆ‘å¦‚ä½•æŠŠé›¶æ•£çš„ Session æ”¹æˆåŸºäº Redis çš„ Token æ–¹æ¡ˆï¼Œå¸Œæœ›ç»™ä¹Ÿåœ¨è‡ªå­¦çš„åŒå­¦ä¸€ç‚¹å‚è€ƒã€‚</p>
<h2 id="é—®é¢˜ç°è±¡ï¼šç™»å½•æ€â€œç¨çºµå³é€â€"><a href="#é—®é¢˜ç°è±¡ï¼šç™»å½•æ€â€œç¨çºµå³é€â€" class="headerlink" title="é—®é¢˜ç°è±¡ï¼šç™»å½•æ€â€œç¨çºµå³é€â€"></a>é—®é¢˜ç°è±¡ï¼šç™»å½•æ€â€œç¨çºµå³é€â€</h2><p>æœ€å¼€å§‹æˆ‘ç›´æ¥ç”¨ Spring Boot è‡ªå¸¦çš„ <code>HttpSession</code> ä¿å­˜ç”¨æˆ·å¯¹è±¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> LoginRequest request, HttpSession session)</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.login(request.getAccount(), request.getPassword());</span><br><span class="line">    session.setAttribute(<span class="string">&quot;user&quot;</span>, user); <span class="comment">// æ˜æ˜å­˜äº†ï¼Œä½†æ€»ä¸¢</span></span><br><span class="line">    <span class="keyword">return</span> Result.success(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éšä¹‹æš´éœ²äº†ä¸‰ä¸ªç—›ç‚¹ï¼š</p>
<ol>
<li>å‰ç«¯ç”¨ Reactï¼Œåˆ·æ–°é¡µé¢å Session ä¸¢å¤±ï¼Œç”¨æˆ·å¾—é‡æ–°ç™»å½•ï¼ˆæœ¬åœ°ä¸¤ä¸ªæµè§ˆå™¨çª—å£å°±èƒ½ç¨³å®šå¤ç°ï¼‰ï¼›</li>
<li>æˆ‘é‡å¯åç«¯æœåŠ¡ï¼Œæ‰€æœ‰ç”¨æˆ·å…¨è¢«è¸¢ä¸‹çº¿ï¼ˆå¼€å‘ç¯å¢ƒé‡å¯ä¸€æ¬¡å°±å¾—é‡æ–°ç™»å½•ä¸€éï¼‰ï¼›</li>
<li>åŒä¸€è´¦å· PC ç™»å½•åï¼Œæ‰‹æœºç«¯å®Œå…¨æ„ŸçŸ¥ä¸åˆ°çŠ¶æ€ï¼ˆæˆ‘ç”¨åŒä¸€ Wi-Fi ä¸‹çš„æ‰‹æœºè®¿é—®æœ¬åœ°è°ƒè¯•åœ°å€éªŒè¯çš„ï¼‰ã€‚</li>
</ol>
<h2 id="è§£å†³è¿‡ç¨‹ï¼šRedis-Token"><a href="#è§£å†³è¿‡ç¨‹ï¼šRedis-Token" class="headerlink" title="è§£å†³è¿‡ç¨‹ï¼šRedis + Token"></a>è§£å†³è¿‡ç¨‹ï¼šRedis + Token</h2><h3 id="1-æŠ€æœ¯é€‰å‹"><a href="#1-æŠ€æœ¯é€‰å‹" class="headerlink" title="1. æŠ€æœ¯é€‰å‹"></a>1. æŠ€æœ¯é€‰å‹</h3><p>æˆ‘è°ƒç ”äº†ä¸‰ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>åŸç”Ÿ Session</strong>ï¼šä¾èµ–å•æœºå†…å­˜ï¼Œé‡å¯æˆ–å¤šå®ä¾‹æ—¶ä¼šæ··ä¹±ï¼›</li>
<li><strong>JWT</strong>ï¼šæ— çŠ¶æ€ä½†æ— æ³•ä¸»åŠ¨å¤±æ•ˆï¼Œå¯¹æˆ‘ç°åœ¨çš„éœ€æ±‚æ¥è¯´ä¸å¥½æ§åˆ¶ï¼›</li>
<li><strong>Redis + Token</strong>ï¼šç™»å½•åç”Ÿæˆ Tokenï¼ŒæŠŠç”¨æˆ·ä¿¡æ¯æ”¾åˆ° Redisï¼Œå¯æ§å¯å¤±æ•ˆï¼Œè¿˜èƒ½æ‰©å±•åˆ°å¤šèŠ‚ç‚¹ã€‚</li>
</ul>
<p>ç»¼åˆå¤æ‚åº¦å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘é€‰æ‹©ç¬¬ä¸‰ç§ã€‚</p>
<h3 id="2-å¼•å…¥-Redis-ä¾èµ–"><a href="#2-å¼•å…¥-Redis-ä¾èµ–" class="headerlink" title="2. å¼•å…¥ Redis ä¾èµ–"></a>2. å¼•å…¥ Redis ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-é…ç½®-Redis-è¿æ¥"><a href="#3-é…ç½®-Redis-è¿æ¥" class="headerlink" title="3. é…ç½® Redis è¿æ¥"></a>3. é…ç½® Redis è¿æ¥</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°ç”¨ Docker èµ·äº†ä¸€ä¸ª Redisï¼Œæ­£å¼ç¯å¢ƒä¹Ÿèƒ½ç›´æ¥å¤ç”¨é…ç½®ã€‚</p>
<h3 id="4-Token-å·¥å…·ç±»"><a href="#4-Token-å·¥å…·ç±»" class="headerlink" title="4. Token å·¥å…·ç±»"></a>4. Token å·¥å…·ç±»</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">generateToken</span><span class="params">(Long userId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;USER_TOKEN:&quot;</span> + UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">storeToken</span><span class="params">(String token, UserDTO user)</span> &#123;</span><br><span class="line">        redisTemplate.opsForValue().set(token,</span><br><span class="line">                JSON.toJSONString(user),</span><br><span class="line">                <span class="number">2</span>,</span><br><span class="line">                TimeUnit.HOURS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">verifyToken</span><span class="params">(String token)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userJson</span> <span class="operator">=</span> redisTemplate.opsForValue().get(token);</span><br><span class="line">        <span class="keyword">if</span> (userJson == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        redisTemplate.expire(token, <span class="number">2</span>, TimeUnit.HOURS);</span><br><span class="line">        <span class="keyword">return</span> JSON.parseObject(userJson, UserDTO.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘åœ¨è¿™é‡Œåˆ»æ„ç”¨äº† <code>UserDTO</code>ï¼ŒæŠŠå¯†ç å“ˆå¸Œç­‰æ•æ„Ÿå­—æ®µå»æ‰ï¼Œé¿å… Redis é‡Œå­˜å…¨é‡å¯¹è±¡ã€‚è™½ç„¶æš‚æ—¶è¿˜æ²¡éƒ¨ç½²ï¼Œä½†è¶æ—©æŠŠæ•æ„Ÿå­—æ®µå‰¥ç¦»æ‰ä¹Ÿèƒ½é¿å…åé¢è¿ç§»æ—¶æ‰‹å¿™è„šä¹±ã€‚</p>
<h3 id="5-æ”¹é€ ç™»å½•æ¥å£"><a href="#5-æ”¹é€ ç™»å½•æ¥å£" class="headerlink" title="5. æ”¹é€ ç™»å½•æ¥å£"></a>5. æ”¹é€ ç™»å½•æ¥å£</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> LoginRequest request)</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.login(request.getAccount(), request.getPassword());</span><br><span class="line">    <span class="type">UserDTO</span> <span class="variable">safeUser</span> <span class="operator">=</span> UserConvertor.toDTO(user);</span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> tokenUtils.generateToken(user.getId());</span><br><span class="line">    tokenUtils.storeToken(token, safeUser);</span><br><span class="line">    <span class="keyword">return</span> Result.success(<span class="keyword">new</span> <span class="title class_">LoginResponse</span>(token, safeUser));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‰ç«¯æ‹¿åˆ° Token åå†™å…¥ <code>localStorage</code>ï¼Œè¯·æ±‚æ—¶æ”¾åˆ° <code>Authorization</code> å¤´é‡Œã€‚ç°é˜¶æ®µåªæ˜¯æˆ‘è‡ªå·±åœ¨æµè§ˆå™¨é‡Œè°ƒè¯•ï¼Œä½†ç­‰ä»¥åéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒåªéœ€è¦æŠŠåŸºå€è°ƒä¸€ä¸‹å°±èƒ½ç»§ç»­æ²¿ç”¨ã€‚</p>
<h3 id="6-æ‹¦æˆªå™¨æ ¡éªŒç™»å½•æ€"><a href="#6-æ‹¦æˆªå™¨æ ¡éªŒç™»å½•æ€" class="headerlink" title="6. æ‹¦æˆªå™¨æ ¡éªŒç™»å½•æ€"></a>6. æ‹¦æˆªå™¨æ ¡éªŒç™»å½•æ€</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TokenUtils tokenUtils;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request,</span></span><br><span class="line"><span class="params">                             HttpServletResponse response,</span></span><br><span class="line"><span class="params">                             Object handler)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.hasText(token)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;æœªç™»å½•&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">UserDTO</span> <span class="variable">user</span> <span class="operator">=</span> tokenUtils.verifyToken(token);</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;ç™»å½•å·²è¿‡æœŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        UserContext.set(user); <span class="comment">// ThreadLocal ä¿å­˜ï¼Œæ–¹ä¾¿åç»­è·å–</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>WebMvcConfigurer</code> é‡ŒæŠŠæ‹¦æˆªå™¨æ³¨å†Œåˆ°éœ€è¦é‰´æƒçš„æ¥å£å³å¯ã€‚</p>
<h2 id="è¸©å‘è®°å½•"><a href="#è¸©å‘è®°å½•" class="headerlink" title="è¸©å‘è®°å½•"></a>è¸©å‘è®°å½•</h2><ul>
<li><strong>Token ä¼ é€’æ–¹å¼</strong>ï¼šæœ€æ—©æ”¾åœ¨ URL æŸ¥è¯¢å‚æ•°ï¼Œåˆ·æ–°å’Œå¤åˆ¶é“¾æ¥éƒ½ä¼šæ³„éœ²ï¼Œæœ€åæ”¹æˆ <code>Authorization</code> å¤´ï¼›</li>
<li><strong>Redis åºåˆ—åŒ–</strong>ï¼šé»˜è®¤ <code>JdkSerializationRedisSerializer</code> è®© Key å‡ºç°ä¹±ç ï¼Œæˆ‘ç»Ÿä¸€æ”¹ç”¨ <code>StringRedisTemplate</code> + JSONï¼›</li>
<li><strong>ä¸»åŠ¨ä¸‹çº¿</strong>ï¼š<code>verifyToken</code> å¤±è´¥æ—¶ç›´æ¥æŠ›å¼‚å¸¸ï¼Œè¿™æ ·ç”¨æˆ·åœ¨åˆ«çš„è®¾å¤‡ç™»å½•ä¼šè§¦å‘æ—§ Token å¤±æ•ˆï¼›</li>
<li><strong>è¶…æ—¶ç»­æœŸ</strong>ï¼šæ¯æ¬¡éªŒè¯æˆåŠŸååˆ·æ–°è¿‡æœŸæ—¶é—´ï¼Œç”¨æˆ·åªè¦æ´»è·ƒå°±ä¸ä¼šè¢«è¸¢ã€‚</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™æ¬¡æŸ¥äº†ä¸å°‘èµ„æ–™è®©æˆ‘ç†è§£äº†â€ç™»å½•æ€&#x3D;å¦‚ä½•å®‰å…¨è®°ä½ç”¨æˆ·â€ã€‚åŸç”Ÿ Session åœ¨å•æœºè°ƒè¯•è¿˜è¡Œï¼Œä½†é‡åˆ°å¤šç«¯ã€å¤šå®ä¾‹å°±åŠ›ä¸ä»å¿ƒï¼Œæ›´åˆ«è¯´ä»¥åä¸Šçº¿éƒ¨ç½²ï¼ˆå¯èƒ½æœ‰å§ ã€‚Redis + Token è™½ç„¶å¤šå†™äº†ç‚¹ä»£ç ï¼Œå´è§£å†³äº†åˆ·æ–°ã€é‡å¯ã€åˆ†å¸ƒå¼å’Œä¸»åŠ¨å¤±æ•ˆçš„é—®é¢˜ã€‚ä¸‹ä¸€ç¯‡æ­£å¸¸è¿˜ä¼šç»§ç»­è®°å½•è¿™ä¸ªé¡¹ç›®ï¼Œä¹Ÿç®—æ˜¯ç£ä¿ƒè‡ªå·±è¿›æ­¥äº†ï¼Œå¸Œæœ›è¿˜èƒ½åšæŒå†™ä¸‹å»ã€‚</p>
<hr>
<h2 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h2><p>è¿™ä¸ªç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ç³»åˆ—çš„å…¶ä»–æ–‡ç« ï¼š</p>
<ul>
<li><a href="/2024/11/15/2024-11-15-password-security/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 1ï¼šå¯†ç åŠ å¯†é‚£äº›äº‹å„¿</a></li>
<li><a href="/2024/11/26/2024-11-26-user-center-database-design/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®çš„æ•°æ®åº“è®¾è®¡ï¼šå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="/2024/11/29/2024-11-29-user-center-project-summary/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®æ€»ç»“ï¼šä» 0 åˆ° 1 çš„å®Œæ•´å®è·µ</a></li>
</ul>
]]></content>
      <categories>
        <category>Debug ç»éªŒ</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
        <tag>ç”¨æˆ·ä¸­å¿ƒ</tag>
        <tag>Session</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¨‹åºå‘˜ä¸ä¸€å®šçŸ¥é“çš„10ä¸ªæŠ€æœ¯å†·çŸ¥è¯†</title>
    <url>/2024/11/25/2024-11-25-programming-cold-knowledge/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ç¼–ç¨‹çš„ä¸–ç•Œé‡Œï¼Œæ€»æœ‰ä¸€äº›æœ‰è¶£ä½†å®¹æ˜“è¢«å¿½è§†çš„çŸ¥è¯†ç‚¹ã€‚è¿™äº›â€å†·çŸ¥è¯†â€å¯èƒ½ä¸ä¼šç›´æ¥å½±å“ä½ çš„ä»£ç ï¼Œä½†äº†è§£å®ƒä»¬èƒ½è®©ä½ å¯¹ç¼–ç¨‹æœ‰æ›´æ·±çš„ç†è§£ï¼ˆè€Œä¸”èŠå¤©çš„æ—¶å€™å¯ä»¥è£…X ğŸ˜ï¼‰ã€‚ä»Šå¤©åˆ†äº«ä¸€äº›æˆ‘è§‰å¾—æœ‰è¶£çš„æŠ€æœ¯å†·çŸ¥è¯†ã€‚</p>
<h2 id="1-ä¸ºä»€ä¹ˆæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Ÿ</h2><p>è¿™æ˜¯ä¸€ä¸ªç»å…¸é—®é¢˜ã€‚æ•°ç»„ç´¢å¼•ä»0å¼€å§‹çš„åŸå› æœ‰å¤šç§è¯´æ³•ï¼š</p>
<h3 id="å†å²åŸå› "><a href="#å†å²åŸå› " class="headerlink" title="å†å²åŸå› "></a>å†å²åŸå› </h3><p>åœ¨Cè¯­è¨€ä¸­ï¼Œæ•°ç»„åå®é™…ä¸Šæ˜¯æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚æ‰€ä»¥ <code>arr[i]</code> å®é™…ä¸Šç­‰ä»·äº <code>*(arr + i)</code>ï¼Œå³ä»æ•°ç»„èµ·å§‹åœ°å€åç§» <code>i</code> ä¸ªå…ƒç´ å¤§å°çš„ä½ç½®ã€‚</p>
<p>å¦‚æœä»1å¼€å§‹ï¼Œé‚£ä¹ˆ <code>arr[i]</code> å°±éœ€è¦å†™æˆ <code>*(arr + i - 1)</code>ï¼Œå¤šäº†ä¸€æ¬¡å‡æ³•è¿ç®—ã€‚</p>
<h3 id="æ•°å­¦åŸå› "><a href="#æ•°å­¦åŸå› " class="headerlink" title="æ•°å­¦åŸå› "></a>æ•°å­¦åŸå› </h3><p>ä»æ•°å­¦è§’åº¦çœ‹ï¼Œç´¢å¼•ä»0å¼€å§‹æ›´ç¬¦åˆâ€åç§»é‡â€çš„æ¦‚å¿µï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå…ƒç´ ï¼šåç§»0ä¸ªå•ä½</li>
<li>ç¬¬äºŒä¸ªå…ƒç´ ï¼šåç§»1ä¸ªå•ä½</li>
<li>ç¬¬nä¸ªå…ƒç´ ï¼šåç§»n-1ä¸ªå•ä½</li>
</ul>
<h3 id="å®é™…å½±å“"><a href="#å®é™…å½±å“" class="headerlink" title="å®é™…å½±å“"></a>å®é™…å½±å“</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä»0å¼€å§‹ï¼šç¬¬iä¸ªå…ƒç´ çš„ç´¢å¼•å°±æ˜¯i</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    arr[i] = i;  <span class="comment">// ç®€æ´</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœä»1å¼€å§‹ï¼šç¬¬iä¸ªå…ƒç´ çš„ç´¢å¼•æ˜¯i-1</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= arr.length; i++) &#123;</span><br><span class="line">    arr[i-<span class="number">1</span>] = i;  <span class="comment">// éœ€è¦å‡1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-ä¸ºä»€ä¹ˆå«â€Bugâ€ï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆå«â€Bugâ€ï¼Ÿ" class="headerlink" title="2. ä¸ºä»€ä¹ˆå«â€Bugâ€ï¼Ÿ"></a>2. ä¸ºä»€ä¹ˆå«â€Bugâ€ï¼Ÿ</h2><p>1947å¹´ï¼Œå“ˆä½›å¤§å­¦çš„Mark IIè®¡ç®—æœºå‡ºç°æ•…éšœã€‚å·¥ç¨‹å¸ˆGrace Hopperåœ¨ç»§ç”µå™¨ä¸­å‘ç°äº†ä¸€åªé£è›¾ï¼Œå¥¹å°†è¿™åªé£è›¾ç”¨èƒ¶å¸¦è´´åœ¨äº†æ—¥å¿—æœ¬ä¸Šï¼Œå¹¶æ ‡æ³¨â€First actual case of bug being foundâ€ï¼ˆå‘ç°bugçš„ç¬¬ä¸€ä¸ªå®é™…æ¡ˆä¾‹ï¼‰ã€‚</p>
<p>ä»æ­¤ï¼Œâ€bugâ€å°±æˆäº†ç¨‹åºé”™è¯¯çš„ä»£åè¯ã€‚</p>
<p>æœ‰è¶£çš„æ˜¯ï¼Œåœ¨Grace Hopperä¹‹å‰ï¼ŒThomas Edisonå°±å·²ç»ç”¨â€bugâ€æ¥å½¢å®¹æŠ€æœ¯é—®é¢˜äº†ã€‚ä»–åœ¨1878å¹´çš„ä¸€å°ä¿¡ä¸­å†™é“ï¼šâ€It has been just so in all of my inventions. The first step is an intuition, and comes with a burst, then difficulties ariseâ€”this thing gives out and [it is] then that â€˜Bugsâ€™â€”as such little faults and difficulties are calledâ€”show themselvesâ€¦â€</p>
<h2 id="3-ä¸ºä»€ä¹ˆå«â€Fooâ€å’Œâ€Barâ€ï¼Ÿ"><a href="#3-ä¸ºä»€ä¹ˆå«â€Fooâ€å’Œâ€Barâ€ï¼Ÿ" class="headerlink" title="3. ä¸ºä»€ä¹ˆå«â€Fooâ€å’Œâ€Barâ€ï¼Ÿ"></a>3. ä¸ºä»€ä¹ˆå«â€Fooâ€å’Œâ€Barâ€ï¼Ÿ</h2><p>åœ¨ç¼–ç¨‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ° <code>foo</code>ã€<code>bar</code>ã€<code>baz</code> è¿™æ ·çš„å˜é‡åã€‚è¿™äº›åå­—æ¥è‡ªå“ªé‡Œï¼Ÿ</p>
<h3 id="å†å²æ¥æº"><a href="#å†å²æ¥æº" class="headerlink" title="å†å²æ¥æº"></a>å†å²æ¥æº</h3><p>â€œFooâ€å¯èƒ½æ¥è‡ªäºŒæˆ˜æ—¶æœŸçš„å†›äº‹ä¿šè¯­â€FUBARâ€ï¼ˆFucked Up Beyond All Recognitionï¼‰ï¼Œæ„æ€æ˜¯â€å®Œå…¨æç ¸äº†â€ã€‚</p>
<p>â€œBarâ€å¯èƒ½æ˜¯â€fooâ€çš„æŠ¼éŸµè¯ï¼Œæˆ–è€…æ˜¯â€beyond all recognitionâ€çš„ç¼©å†™ã€‚</p>
<h3 id="ä½¿ç”¨ä¹ æƒ¯"><a href="#ä½¿ç”¨ä¹ æƒ¯" class="headerlink" title="ä½¿ç”¨ä¹ æƒ¯"></a>ä½¿ç”¨ä¹ æƒ¯</h3><p>è¿™äº›åå­—å·²ç»æˆä¸ºç¼–ç¨‹ä¸­çš„â€å ä½ç¬¦â€ï¼Œè¡¨ç¤ºâ€è¿™é‡Œåº”è¯¥æœ‰ä¸€ä¸ªæœ‰æ„ä¹‰çš„å˜é‡åï¼Œä½†ä¸ºäº†ç¤ºä¾‹ç®€æ´ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªæ— æ„ä¹‰çš„åç§°â€ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ä»£ç </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processFoo</span><span class="params">(Foo foo)</span> &#123;</span><br><span class="line">    <span class="type">Bar</span> <span class="variable">bar</span> <span class="operator">=</span> foo.getBar();</span><br><span class="line">    <span class="type">Baz</span> <span class="variable">baz</span> <span class="operator">=</span> bar.getBaz();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-ä¸ºä»€ä¹ˆHTTPçŠ¶æ€ç æ˜¯ä¸‰ä½æ•°ï¼Ÿ"><a href="#4-ä¸ºä»€ä¹ˆHTTPçŠ¶æ€ç æ˜¯ä¸‰ä½æ•°ï¼Ÿ" class="headerlink" title="4. ä¸ºä»€ä¹ˆHTTPçŠ¶æ€ç æ˜¯ä¸‰ä½æ•°ï¼Ÿ"></a>4. ä¸ºä»€ä¹ˆHTTPçŠ¶æ€ç æ˜¯ä¸‰ä½æ•°ï¼Ÿ</h2><p>HTTPçŠ¶æ€ç ä½¿ç”¨ä¸‰ä½æ•°å­—ï¼Œè¿™æ˜¯æœ‰åŸå› çš„ï¼š</p>
<h3 id="è®¾è®¡åŸå› "><a href="#è®¾è®¡åŸå› " class="headerlink" title="è®¾è®¡åŸå› "></a>è®¾è®¡åŸå› </h3><ul>
<li><p><strong>ç¬¬ä¸€ä½æ•°å­—</strong>ï¼šè¡¨ç¤ºå“åº”ç±»åˆ«</p>
<ul>
<li>1xxï¼šä¿¡æ¯æ€§å“åº”</li>
<li>2xxï¼šæˆåŠŸå“åº”</li>
<li>3xxï¼šé‡å®šå‘</li>
<li>4xxï¼šå®¢æˆ·ç«¯é”™è¯¯</li>
<li>5xxï¼šæœåŠ¡å™¨é”™è¯¯</li>
</ul>
</li>
<li><p><strong>åä¸¤ä½æ•°å­—</strong>ï¼šè¡¨ç¤ºå…·ä½“çš„é”™è¯¯ç±»å‹</p>
</li>
</ul>
<h3 id="æ‰©å±•æ€§"><a href="#æ‰©å±•æ€§" class="headerlink" title="æ‰©å±•æ€§"></a>æ‰©å±•æ€§</h3><p>è¿™ç§è®¾è®¡å…è®¸ï¼š</p>
<ul>
<li>åœ¨ç°æœ‰ç±»åˆ«ä¸­æ·»åŠ æ–°çš„çŠ¶æ€ç ï¼ˆå¦‚201 Createdï¼‰</li>
<li>è‡ªå®šä¹‰çŠ¶æ€ç ï¼ˆè™½ç„¶ä¸æ¨èï¼‰</li>
<li>å®¢æˆ·ç«¯å¯ä»¥æ ¹æ®ç¬¬ä¸€ä½æ•°å­—å¿«é€Ÿåˆ¤æ–­å“åº”ç±»å‹</li>
</ul>
<h2 id="5-ä¸ºä»€ä¹ˆå«â€Cookieâ€ï¼Ÿ"><a href="#5-ä¸ºä»€ä¹ˆå«â€Cookieâ€ï¼Ÿ" class="headerlink" title="5. ä¸ºä»€ä¹ˆå«â€Cookieâ€ï¼Ÿ"></a>5. ä¸ºä»€ä¹ˆå«â€Cookieâ€ï¼Ÿ</h2><p>HTTP Cookieçš„åå­—æ¥è‡ªâ€magic cookieâ€ï¼ˆé­”æ³•é¥¼å¹²ï¼‰ï¼Œè¿™æ˜¯Unixç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼ŒæŒ‡çš„æ˜¯ä¸€å°æ®µæ•°æ®ï¼Œç¨‹åºå¯ä»¥è¯»å–å®ƒï¼Œä½†é€šå¸¸ä¸èƒ½ä¿®æ”¹ã€‚</p>
<h3 id="å‘½åæ¥æº"><a href="#å‘½åæ¥æº" class="headerlink" title="å‘½åæ¥æº"></a>å‘½åæ¥æº</h3><p>Lou Montulliåœ¨1994å¹´å‘æ˜äº†HTTP Cookieã€‚ä»–é€‰æ‹©è¿™ä¸ªåå­—æ˜¯å› ä¸ºï¼š</p>
<ol>
<li>Cookieæ˜¯â€magic cookieâ€çš„ç®€ç§°</li>
<li>Cookieæ˜¯â€å°ç”œç‚¹â€ï¼Œå°±åƒHTTP Cookieæ˜¯â€å°æ•°æ®ç‰‡æ®µâ€</li>
<li>åå­—ç®€å•æ˜“è®°</li>
</ol>
<h3 id="æœ‰è¶£çš„äº‹å®"><a href="#æœ‰è¶£çš„äº‹å®" class="headerlink" title="æœ‰è¶£çš„äº‹å®"></a>æœ‰è¶£çš„äº‹å®</h3><p>Cookieçš„æ­£å¼åç§°æ˜¯â€HTTP State Management Mechanismâ€ï¼ˆHTTPçŠ¶æ€ç®¡ç†æœºåˆ¶ï¼‰ï¼Œä½†â€Cookieâ€è¿™ä¸ªåå­—æ›´æµè¡Œã€‚</p>
<h2 id="6-ä¸ºä»€ä¹ˆå«â€Spamâ€ï¼ˆåƒåœ¾é‚®ä»¶ï¼‰ï¼Ÿ"><a href="#6-ä¸ºä»€ä¹ˆå«â€Spamâ€ï¼ˆåƒåœ¾é‚®ä»¶ï¼‰ï¼Ÿ" class="headerlink" title="6. ä¸ºä»€ä¹ˆå«â€Spamâ€ï¼ˆåƒåœ¾é‚®ä»¶ï¼‰ï¼Ÿ"></a>6. ä¸ºä»€ä¹ˆå«â€Spamâ€ï¼ˆåƒåœ¾é‚®ä»¶ï¼‰ï¼Ÿ</h2><p>â€œSpamâ€è¿™ä¸ªè¯æ¥è‡ªMonty Pythonçš„å–œå‰§å°å“ï¼Œå…¶ä¸­Spamï¼ˆåˆé¤è‚‰ç½å¤´ï¼‰åœ¨èœå•ä¸Šåå¤å‡ºç°ï¼Œè®©äººåŒçƒ¦ã€‚</p>
<p>åæ¥ï¼Œè¿™ä¸ªè¯è¢«ç”¨æ¥å½¢å®¹ï¼š</p>
<ul>
<li>åƒåœ¾é‚®ä»¶ï¼ˆEmail Spamï¼‰</li>
<li>åƒåœ¾è¯„è®ºï¼ˆComment Spamï¼‰</li>
<li>åƒåœ¾ä¿¡æ¯ï¼ˆMessage Spamï¼‰</li>
</ul>
<h3 id="æŠ€æœ¯å«ä¹‰"><a href="#æŠ€æœ¯å«ä¹‰" class="headerlink" title="æŠ€æœ¯å«ä¹‰"></a>æŠ€æœ¯å«ä¹‰</h3><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œâ€spamâ€é€šå¸¸æŒ‡ï¼š</p>
<ul>
<li>é‡å¤å‘é€å¤§é‡æ— æ„ä¹‰çš„æ¶ˆæ¯</li>
<li>æ¶æ„åˆ·å±</li>
<li>è‡ªåŠ¨åŒ–æ”»å‡»</li>
</ul>
<h2 id="7-ä¸ºä»€ä¹ˆå«â€Daemonâ€ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ï¼Ÿ"><a href="#7-ä¸ºä»€ä¹ˆå«â€Daemonâ€ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ï¼Ÿ" class="headerlink" title="7. ä¸ºä»€ä¹ˆå«â€Daemonâ€ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ï¼Ÿ"></a>7. ä¸ºä»€ä¹ˆå«â€Daemonâ€ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ï¼Ÿ</h2><p>åœ¨Unix&#x2F;Linuxç³»ç»Ÿä¸­ï¼Œåå°è¿è¡Œçš„è¿›ç¨‹å«â€daemonâ€ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ã€‚</p>
<h3 id="å‘½åæ¥æº-1"><a href="#å‘½åæ¥æº-1" class="headerlink" title="å‘½åæ¥æº"></a>å‘½åæ¥æº</h3><p>â€œDaemonâ€æ¥è‡ªå¸Œè…Šç¥è¯ä¸­çš„â€Î´Î±Î¯Î¼Ï‰Î½â€ï¼ˆdaimonï¼‰ï¼ŒæŒ‡çš„æ˜¯ä»‹äºç¥å’Œäººä¹‹é—´çš„è¶…è‡ªç„¶å­˜åœ¨ï¼Œå®ƒä»¬é»˜é»˜å·¥ä½œï¼Œä¸è¢«äººæ³¨æ„ã€‚</p>
<h3 id="æŠ€æœ¯å«ä¹‰-1"><a href="#æŠ€æœ¯å«ä¹‰-1" class="headerlink" title="æŠ€æœ¯å«ä¹‰"></a>æŠ€æœ¯å«ä¹‰</h3><p>å®ˆæŠ¤è¿›ç¨‹çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>åœ¨åå°è¿è¡Œ</li>
<li>æ²¡æœ‰æ§åˆ¶ç»ˆç«¯</li>
<li>é€šå¸¸ä»¥rootæƒé™è¿è¡Œ</li>
<li>ä¸ºç³»ç»Ÿæä¾›æœåŠ¡</li>
</ul>
<p>ä¾‹å¦‚ï¼š<code>httpd</code>ï¼ˆWebæœåŠ¡å™¨ï¼‰ã€<code>mysqld</code>ï¼ˆæ•°æ®åº“æœåŠ¡å™¨ï¼‰ã€<code>sshd</code>ï¼ˆSSHæœåŠ¡å™¨ï¼‰ã€‚</p>
<h2 id="8-ä¸ºä»€ä¹ˆå«â€Pingâ€ï¼Ÿ"><a href="#8-ä¸ºä»€ä¹ˆå«â€Pingâ€ï¼Ÿ" class="headerlink" title="8. ä¸ºä»€ä¹ˆå«â€Pingâ€ï¼Ÿ"></a>8. ä¸ºä»€ä¹ˆå«â€Pingâ€ï¼Ÿ</h2><p><code>ping</code> å‘½ä»¤çš„åå­—æ¥è‡ªå£°çº³çš„â€pingâ€å£°ã€‚</p>
<h3 id="å‘½åæ¥æº-2"><a href="#å‘½åæ¥æº-2" class="headerlink" title="å‘½åæ¥æº"></a>å‘½åæ¥æº</h3><p>Mike Muussåœ¨1983å¹´ç¼–å†™äº†pingç¨‹åºã€‚ä»–é€‰æ‹©è¿™ä¸ªåå­—æ˜¯å› ä¸ºï¼š</p>
<ol>
<li>å£°çº³å‘å‡ºâ€pingâ€å£°æ¥æ¢æµ‹ç‰©ä½“</li>
<li>pingç¨‹åºå‘é€æ•°æ®åŒ…æ¥æ¢æµ‹ç½‘ç»œè¿æ¥</li>
<li>ä¸¤è€…éƒ½æ˜¯â€æ¢æµ‹â€çš„æ¦‚å¿µ</li>
</ol>
<h3 id="æŠ€æœ¯å«ä¹‰-2"><a href="#æŠ€æœ¯å«ä¹‰-2" class="headerlink" title="æŠ€æœ¯å«ä¹‰"></a>æŠ€æœ¯å«ä¹‰</h3><p>pingçš„å·¥ä½œåŸç†ï¼š</p>
<ol>
<li>å‘é€ICMP Echo RequeståŒ…</li>
<li>ç­‰å¾…ç›®æ ‡ä¸»æœºè¿”å›ICMP Echo ReplyåŒ…</li>
<li>è®¡ç®—å¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰</li>
</ol>
<h2 id="9-ä¸ºä»€ä¹ˆå«â€Stack-Overflowâ€ï¼Ÿ"><a href="#9-ä¸ºä»€ä¹ˆå«â€Stack-Overflowâ€ï¼Ÿ" class="headerlink" title="9. ä¸ºä»€ä¹ˆå«â€Stack Overflowâ€ï¼Ÿ"></a>9. ä¸ºä»€ä¹ˆå«â€Stack Overflowâ€ï¼Ÿ</h2><p>Stack Overflowï¼ˆæ ˆæº¢å‡ºï¼‰æ˜¯ä¸€ä¸ªè‘—åçš„ç¼–ç¨‹é—®ç­”ç½‘ç«™ã€‚</p>
<h3 id="æŠ€æœ¯å«ä¹‰-3"><a href="#æŠ€æœ¯å«ä¹‰-3" class="headerlink" title="æŠ€æœ¯å«ä¹‰"></a>æŠ€æœ¯å«ä¹‰</h3><p>â€œStack Overflowâ€æ˜¯ä¸€ä¸ªç¼–ç¨‹æœ¯è¯­ï¼ŒæŒ‡çš„æ˜¯ï¼š</p>
<ul>
<li>å½“ç¨‹åºè°ƒç”¨æ ˆè¶…å‡ºå¯ç”¨å†…å­˜æ—¶</li>
<li>ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ</li>
<li>æ˜¯ä¸€ä¸ªå¸¸è§çš„ç¼–ç¨‹é”™è¯¯</li>
</ul>
<h3 id="ç½‘ç«™å‘½å"><a href="#ç½‘ç«™å‘½å" class="headerlink" title="ç½‘ç«™å‘½å"></a>ç½‘ç«™å‘½å</h3><p>ç½‘ç«™åˆ›å§‹äººé€‰æ‹©è¿™ä¸ªåå­—æ˜¯å› ä¸ºï¼š</p>
<ol>
<li>è¿™æ˜¯ä¸€ä¸ªç¨‹åºå‘˜éƒ½ç†Ÿæ‚‰çš„æœ¯è¯­</li>
<li>æš—ç¤ºâ€é—®é¢˜å¤ªå¤šï¼Œæ ˆæº¢å‡ºäº†â€</li>
<li>å®¹æ˜“è®°å¿†å’Œä¼ æ’­</li>
</ol>
<h2 id="10-ä¸ºä»€ä¹ˆå«â€Gitâ€ï¼Ÿ"><a href="#10-ä¸ºä»€ä¹ˆå«â€Gitâ€ï¼Ÿ" class="headerlink" title="10. ä¸ºä»€ä¹ˆå«â€Gitâ€ï¼Ÿ"></a>10. ä¸ºä»€ä¹ˆå«â€Gitâ€ï¼Ÿ</h2><p>Gitæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚</p>
<h3 id="å‘½åæ¥æº-3"><a href="#å‘½åæ¥æº-3" class="headerlink" title="å‘½åæ¥æº"></a>å‘½åæ¥æº</h3><p>Linus Torvaldsï¼ˆLinuxçš„åˆ›å§‹äººï¼‰åœ¨2005å¹´åˆ›å»ºäº†Gitã€‚ä»–é€‰æ‹©è¿™ä¸ªåå­—æ˜¯å› ä¸ºï¼š</p>
<ol>
<li>â€œGitâ€åœ¨è‹±è¯­ä¿šè¯­ä¸­æ˜¯â€æ„šè ¢çš„äººâ€çš„æ„æ€</li>
<li>Linusè‡ªå˜²åœ°è¯´ï¼šâ€Iâ€™m an egotistical bastard, and I name all my projects after myself. First â€˜Linuxâ€™, now â€˜Gitâ€™.â€</li>
<li>ä½†å®é™…ä¸Šï¼Œâ€Gitâ€å¯èƒ½æ˜¯â€Global Information Trackerâ€çš„ç¼©å†™</li>
</ol>
<h3 id="æœ‰è¶£çš„äº‹å®-1"><a href="#æœ‰è¶£çš„äº‹å®-1" class="headerlink" title="æœ‰è¶£çš„äº‹å®"></a>æœ‰è¶£çš„äº‹å®</h3><p>Gitçš„logoæ˜¯ä¸€åªç« é±¼çŒ«ï¼ˆOctocatï¼‰ï¼Œè¿™æ˜¯GitHubçš„å‰ç¥¥ç‰©ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™äº›æŠ€æœ¯å†·çŸ¥è¯†å¯èƒ½ä¸ä¼šç›´æ¥å½±å“ä½ çš„ä»£ç ï¼Œä½†å®ƒä»¬èƒ½è®©ä½ ï¼š</p>
<ol>
<li><strong>ç†è§£å†å²</strong>ï¼šäº†è§£æŠ€æœ¯æœ¯è¯­çš„æ¥æº</li>
<li><strong>åŠ æ·±ç†è§£</strong>ï¼šå¯¹ç¼–ç¨‹æ¦‚å¿µæœ‰æ›´æ·±çš„è®¤è¯†</li>
<li><strong>å¢åŠ è¶£å‘³</strong>ï¼šè®©ç¼–ç¨‹å˜å¾—æ›´æœ‰è¶£</li>
<li><strong>æ‰©å±•çŸ¥è¯†</strong>ï¼šäº†è§£æŠ€æœ¯èƒŒåçš„æ•…äº‹</li>
</ol>
<hr>
<p><strong>æ€è€ƒ</strong>ï¼šæŠ€æœ¯ä¸ä»…ä»…æ˜¯ä»£ç ï¼Œè¿˜æœ‰èƒŒåçš„å†å²ã€æ–‡åŒ–å’Œæ•…äº‹ã€‚äº†è§£è¿™äº›â€å†·çŸ¥è¯†â€ï¼Œèƒ½è®©æˆ‘ä»¬çš„æŠ€æœ¯ä¹‹è·¯æ›´åŠ ä¸°å¯Œå¤šå½©ï¼ˆè€Œä¸”å¯ä»¥å†·æ­»æœ‹å‹å“ˆå“ˆå“ˆï¼‰ã€‚</p>
<p>å¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–æœ‰è¶£çš„æŠ€æœ¯å†·çŸ¥è¯†ï¼Œæ¬¢è¿åˆ†äº«ï¼æ¯•ç«Ÿå­¦ä¹ è·¯ä¸Šï¼Œæœ‰è¶£ä¸€ç‚¹æ€»æ˜¯å¥½çš„ ğŸ˜Š</p>
]]></content>
      <categories>
        <category>éšä¾¿è¯´è¯´</category>
      </categories>
      <tags>
        <tag>éšç¬”</tag>
        <tag>å†·çŸ¥è¯†</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®çš„æ•°æ®åº“è®¾è®¡ï¼šå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</title>
    <url>/2024/11/26/2024-11-26-user-center-database-design/</url>
    <content><![CDATA[<p>ç”¨æˆ·ä¸­å¿ƒæ˜¯å‡ ä¹æ‰€æœ‰ Web åº”ç”¨çš„æ ¸å¿ƒæ¨¡å—ï¼Œè´Ÿè´£ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ç®¡ç†ç­‰å…³é”®åŠŸèƒ½ã€‚æˆ‘åœ¨å­¦ä¹ åç«¯å¼€å‘æ—¶å‘ç°ï¼Œè®¾è®¡ä¸€ä¸ªç”¨æˆ·ä¸­å¿ƒçš„æ•°æ®åº“å¹¶ä¸åƒæƒ³è±¡ä¸­é‚£ä¹ˆç®€å•ã€‚ä»Šå¤©æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€äº›æˆ‘åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä»¥åŠæ‰¾åˆ°çš„è§£å†³æ–¹æ¡ˆã€‚è™½ç„¶æˆ‘è¿˜åœ¨å­¦ä¹ ä¸­ï¼Œä½†è¿™äº›ç»éªŒå¸Œæœ›èƒ½å¸®åŠ©åˆ°åŒæ ·åˆšå…¥é—¨çš„æœ‹å‹ä»¬ã€‚</p>
<h2 id="ä¸€ã€ç”¨æˆ·è¡¨è®¾è®¡çš„æ ¸å¿ƒé—®é¢˜"><a href="#ä¸€ã€ç”¨æˆ·è¡¨è®¾è®¡çš„æ ¸å¿ƒé—®é¢˜" class="headerlink" title="ä¸€ã€ç”¨æˆ·è¡¨è®¾è®¡çš„æ ¸å¿ƒé—®é¢˜"></a>ä¸€ã€ç”¨æˆ·è¡¨è®¾è®¡çš„æ ¸å¿ƒé—®é¢˜</h2><h3 id="1-ä¸»é”®é€‰æ‹©å›°å¢ƒ"><a href="#1-ä¸»é”®é€‰æ‹©å›°å¢ƒ" class="headerlink" title="1. ä¸»é”®é€‰æ‹©å›°å¢ƒ"></a>1. ä¸»é”®é€‰æ‹©å›°å¢ƒ</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šåˆšå¼€å§‹è®¾è®¡ç”¨æˆ·è¡¨æ—¶ï¼Œæˆ‘é‡åˆ°äº†ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šç”¨æˆ· ID åº”è¯¥ç”¨ä»€ä¹ˆç±»å‹ï¼Ÿæ˜¯è‡ªå¢çš„æ•´æ•°ï¼ˆ1, 2, 3â€¦ï¼‰è¿˜æ˜¯ UUIDï¼ˆä¸€ä¸²éšæœºå­—ç¬¦ï¼‰ï¼Ÿç”¨ INT è¿˜æ˜¯ BIGINTï¼Ÿ</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<p>å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œæˆ‘å»ºè®®å…ˆç”¨ <code>INT AUTO_INCREMENT</code>ï¼ŒåŸå› å¾ˆç®€å•ï¼š</p>
<ul>
<li><strong>ç®€å•æ˜“æ‡‚</strong>ï¼šæ•°æ®åº“ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆ 1, 2, 3â€¦ è¿™æ ·çš„ ID</li>
<li><strong>æŸ¥è¯¢å¿«</strong>ï¼šæ•´æ•°æ¯”è¾ƒæ¯”å­—ç¬¦ä¸²å¿«å¾ˆå¤š</li>
<li><strong>å¤Ÿç”¨äº†</strong>ï¼šINT ç±»å‹æœ€å¤§å¯ä»¥å­˜åˆ° 21 äº¿å¤šï¼Œå¯¹äºå­¦ä¹ é¡¹ç›®å®Œå…¨å¤Ÿç”¨</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ç”¨æˆ·ID&#x27;</span>,</span><br><span class="line">  <span class="comment">-- å…¶ä»–å­—æ®µ...</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>æˆ‘çš„ç†è§£</strong>ï¼šå°±åƒç»™æ¯ä¸ªå­¦ç”Ÿåˆ†é…å­¦å·ä¸€æ ·ï¼Œè‡ªå¢ ID ç®€å•ç›´æ¥ã€‚é™¤éä½ çš„åº”ç”¨çœŸçš„éœ€è¦æ”¯æŒè¶…è¿‡ 21 äº¿ç”¨æˆ·ï¼ˆè¿™å‡ ä¹ä¸å¯èƒ½ï¼‰ï¼Œå¦åˆ™ä¸éœ€è¦ç”¨ BIGINTã€‚UUID è™½ç„¶èƒ½éšè—ç”¨æˆ·æ•°é‡ï¼Œä½†ä¼šè®©æŸ¥è¯¢å˜æ…¢ï¼Œåˆå­¦è€…ä¸å»ºè®®ä½¿ç”¨ã€‚</p>
<h3 id="2-å¤šç™»å½•æ–¹å¼çš„å…¼å®¹é—®é¢˜"><a href="#2-å¤šç™»å½•æ–¹å¼çš„å…¼å®¹é—®é¢˜" class="headerlink" title="2. å¤šç™»å½•æ–¹å¼çš„å…¼å®¹é—®é¢˜"></a>2. å¤šç™»å½•æ–¹å¼çš„å…¼å®¹é—®é¢˜</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šç°åœ¨çš„åº”ç”¨é€šå¸¸æ”¯æŒç”¨æˆ·åã€æ‰‹æœºå·ã€é‚®ç®±ç”šè‡³ç¬¬ä¸‰æ–¹è´¦å·ï¼ˆå¾®ä¿¡ã€QQï¼‰ç™»å½•ã€‚åˆšå¼€å§‹æˆ‘ç›´æ¥æŠŠæ‰€æœ‰å­—æ®µéƒ½å¡åˆ°ç”¨æˆ·è¡¨é‡Œï¼Œç»“æœè¡¨å˜å¾—ç‰¹åˆ«ä¹±ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>ä¸»è¡¨æ”¾å¸¸ç”¨å­—æ®µ</strong>ï¼šç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·è¿™äº›å¸¸ç”¨çš„ç™»å½•æ–¹å¼æ”¾åœ¨ä¸»è¡¨</li>
<li><strong>ç¬¬ä¸‰æ–¹ç™»å½•å•ç‹¬æ”¾</strong>ï¼šå¾®ä¿¡ã€QQ è¿™äº›ç¬¬ä¸‰æ–¹ç™»å½•ä¿¡æ¯æ”¾åœ¨å¦ä¸€ä¸ªè¡¨ï¼Œç”¨ <code>user_id</code> å…³è”èµ·æ¥</li>
<li><strong>ç”¨ UNIQUE ä¿è¯å”¯ä¸€</strong>ï¼šç¡®ä¿æ¯ä¸ªé‚®ç®±ã€æ‰‹æœºå·åªèƒ½æ³¨å†Œä¸€æ¬¡</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ä¸»ç”¨æˆ·è¡¨ï¼ˆå­˜æ”¾åŸºæœ¬ä¿¡æ¯ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">  `email` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">  `password_hash` <span class="type">CHAR</span>(<span class="number">60</span>) COMMENT <span class="string">&#x27;å¯†ç å“ˆå¸Œ(bcrypt)&#x27;</span>,</span><br><span class="line">  `status` ENUM(<span class="string">&#x27;active&#x27;</span>, <span class="string">&#x27;inactive&#x27;</span>, <span class="string">&#x27;banned&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;inactive&#x27;</span>,</span><br><span class="line">  `created_at` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">  INDEX `idx_email` (`email`),    <span class="comment">-- ç»™é‚®ç®±å»ºç´¢å¼•ï¼Œç™»å½•æ—¶æŸ¥å¾—å¿«</span></span><br><span class="line">  INDEX `idx_phone` (`phone`)     <span class="comment">-- ç»™æ‰‹æœºå·å»ºç´¢å¼•ï¼Œç™»å½•æ—¶æŸ¥å¾—å¿«</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·åŸºæœ¬ä¿¡æ¯è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç¬¬ä¸‰æ–¹ç™»å½•å…³è”è¡¨ï¼ˆå­˜æ”¾å¾®ä¿¡ã€QQç­‰ç™»å½•ä¿¡æ¯ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `user_oauth` (</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `provider` ENUM(<span class="string">&#x27;wechat&#x27;</span>, <span class="string">&#x27;qq&#x27;</span>, <span class="string">&#x27;github&#x27;</span>, <span class="string">&#x27;google&#x27;</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;ç™»å½•æ–¹å¼&#x27;</span>,</span><br><span class="line">  `provider_user_id` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;ç¬¬ä¸‰æ–¹å¹³å°çš„ç”¨æˆ·ID&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_provider_user` (`provider`, `provider_user_id`)</span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç¬¬ä¸‰æ–¹ç™»å½•å…³è”è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ç®€å•è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>UNIQUE</code>ï¼šä¿è¯è¿™ä¸ªå­—æ®µçš„å€¼ä¸èƒ½é‡å¤ï¼ˆæ¯”å¦‚ä¸èƒ½æœ‰ä¸¤ä¸ªç›¸åŒçš„é‚®ç®±ï¼‰</li>
<li><code>INDEX</code>ï¼šç´¢å¼•å°±åƒä¹¦çš„ç›®å½•ï¼Œèƒ½è®©ä½ å¿«é€Ÿæ‰¾åˆ°æƒ³è¦çš„æ•°æ®</li>
<li><code>FOREIGN KEY</code>ï¼šå¤–é”®ï¼Œä¿è¯ <code>user_oauth</code> è¡¨ä¸­çš„ <code>user_id</code> å¿…é¡»åœ¨ <code>user</code> è¡¨ä¸­å­˜åœ¨</li>
<li><code>ON DELETE CASCADE</code>ï¼šå¦‚æœç”¨æˆ·è¢«åˆ é™¤äº†ï¼Œç›¸å…³çš„ç¬¬ä¸‰æ–¹ç™»å½•ä¿¡æ¯ä¹Ÿä¼šè‡ªåŠ¨åˆ é™¤</li>
</ul>
<h2 id="äºŒã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†çš„æŒ‘æˆ˜"><a href="#äºŒã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†çš„æŒ‘æˆ˜" class="headerlink" title="äºŒã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†çš„æŒ‘æˆ˜"></a>äºŒã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†çš„æŒ‘æˆ˜</h2><h3 id="1-ç”¨æˆ·èµ„æ–™çš„æ‰©å±•æ€§é—®é¢˜"><a href="#1-ç”¨æˆ·èµ„æ–™çš„æ‰©å±•æ€§é—®é¢˜" class="headerlink" title="1. ç”¨æˆ·èµ„æ–™çš„æ‰©å±•æ€§é—®é¢˜"></a>1. ç”¨æˆ·èµ„æ–™çš„æ‰©å±•æ€§é—®é¢˜</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šåˆšå¼€å§‹æˆ‘åªåœ¨ç”¨æˆ·è¡¨é‡Œæ”¾äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œåæ¥æƒ³åŠ å¤´åƒã€æ€§åˆ«ã€ç”Ÿæ—¥â€¦æ¯æ¬¡éƒ½è¦æ”¹è¡¨ç»“æ„ï¼Œç‰¹åˆ«éº»çƒ¦ã€‚è€Œä¸”å¦‚æœä»¥åè¿˜è¦åŠ æ›´å¤šå­—æ®µï¼Œè¡¨ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<p>æˆ‘çš„åšæ³•æ˜¯åˆ†è¡¨å­˜å‚¨ï¼š</p>
<ul>
<li><strong>ä¸»è¡¨æ”¾æ ¸å¿ƒä¿¡æ¯</strong>ï¼šç”¨æˆ·åã€å¯†ç è¿™äº›ç™»å½•å¿…éœ€çš„ä¿¡æ¯</li>
<li><strong>æ‰©å±•è¡¨æ”¾è¯¦ç»†ä¿¡æ¯</strong>ï¼šå¤´åƒã€æ€§åˆ«ã€ç”Ÿæ—¥è¿™äº›æ”¾åœ¨å¦ä¸€ä¸ªè¡¨</li>
<li><strong>åŠ¨æ€å±æ€§è¡¨</strong>ï¼šå¦‚æœä»¥åè¿˜è¦åŠ ä¸€äº›ä¸å¸¸ç”¨çš„å­—æ®µï¼Œå¯ä»¥ç”¨é”®å€¼å¯¹çš„æ–¹å¼å­˜å‚¨</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ç”¨æˆ·æ‰©å±•ä¿¡æ¯è¡¨ï¼ˆå­˜æ”¾å¤´åƒã€æ€§åˆ«ã€ç”Ÿæ—¥ç­‰ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `user_profile` (</span><br><span class="line">  `profile_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `avatar_url` <span class="type">VARCHAR</span>(<span class="number">255</span>) COMMENT <span class="string">&#x27;å¤´åƒURL&#x27;</span>,</span><br><span class="line">  `gender` ENUM(<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>, <span class="string">&#x27;unknown&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;unknown&#x27;</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">  `birthday` <span class="type">DATE</span> COMMENT <span class="string">&#x27;ç”Ÿæ—¥&#x27;</span>,</span><br><span class="line">  `bio` TEXT COMMENT <span class="string">&#x27;ä¸ªäººç®€ä»‹&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_user_id` (`user_id`)  <span class="comment">-- ä¸€ä¸ªç”¨æˆ·åªæœ‰ä¸€æ¡èµ„æ–™</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·è¯¦ç»†èµ„æ–™è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åŠ¨æ€å±æ€§è¡¨ï¼ˆå¦‚æœä»¥åè¦åŠ ä¸€äº›ä¸å¸¸ç”¨çš„å­—æ®µï¼Œå¯ä»¥ç”¨è¿™ä¸ªè¡¨ï¼‰</span></span><br><span class="line"><span class="comment">-- æ¯”å¦‚ï¼šç”¨æˆ·å–œæ¬¢çš„é¢œè‰²ã€åº§å³é“­ç­‰ï¼Œä¸éœ€è¦å•ç‹¬å»ºå­—æ®µ</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `user_attribute` (</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `attr_key` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;å±æ€§åï¼Œæ¯”å¦‚&quot;favorite_color&quot;&#x27;</span>,</span><br><span class="line">  `attr_value` TEXT COMMENT <span class="string">&#x27;å±æ€§å€¼ï¼Œæ¯”å¦‚&quot;è“è‰²&quot;&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_user_attr` (`user_id`, `attr_key`)  <span class="comment">-- ä¸€ä¸ªç”¨æˆ·çš„åŒä¸€ä¸ªå±æ€§åªèƒ½æœ‰ä¸€æ¡</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·åŠ¨æ€å±æ€§è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸ºä»€ä¹ˆè¦åˆ†è¡¨ï¼Ÿ</strong></p>
<ul>
<li>ä¸»è¡¨æŸ¥è¯¢é¢‘ç¹ï¼ˆç™»å½•æ—¶è¦ç”¨ï¼‰ï¼Œå­—æ®µå°‘æŸ¥è¯¢å¿«</li>
<li>æ‰©å±•ä¿¡æ¯ä¸å¸¸æŸ¥è¯¢ï¼Œåˆ†å¼€å­˜å‚¨ä¸ä¼šå½±å“ç™»å½•æ€§èƒ½</li>
<li>ä»¥åè¦åŠ æ–°å­—æ®µï¼Œåªéœ€è¦æ”¹æ‰©å±•è¡¨ï¼Œä¸ç”¨åŠ¨ä¸»è¡¨</li>
</ul>
<h3 id="2-éšç§è®¾ç½®çš„çµæ´»æ§åˆ¶"><a href="#2-éšç§è®¾ç½®çš„çµæ´»æ§åˆ¶" class="headerlink" title="2. éšç§è®¾ç½®çš„çµæ´»æ§åˆ¶"></a>2. éšç§è®¾ç½®çš„çµæ´»æ§åˆ¶</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šæœ‰äº›ç”¨æˆ·å¸Œæœ›æ‰‹æœºå·åªæœ‰è‡ªå·±èƒ½çœ‹åˆ°ï¼Œæœ‰äº›ç”¨æˆ·å¸Œæœ›ç”Ÿæ—¥å¯¹å¥½å‹å¯è§ã€‚å¦‚æœæ¯ä¸ªéšç§è®¾ç½®éƒ½å•ç‹¬å»ºå­—æ®µï¼Œä¼šå¾ˆéº»çƒ¦ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šç”¨ä¸€ä¸ªç‹¬ç«‹çš„éšç§è®¾ç½®è¡¨ï¼Œå¯ä»¥çµæ´»æ§åˆ¶æ¯ä¸ªå­—æ®µçš„å¯è§æ€§ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `user_privacy` (</span><br><span class="line">  `privacy_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `field` ENUM(<span class="string">&#x27;profile&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;phone&#x27;</span>, <span class="string">&#x27;birthday&#x27;</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;è¦è®¾ç½®éšç§çš„å­—æ®µ&#x27;</span>,</span><br><span class="line">  `visibility` ENUM(<span class="string">&#x27;public&#x27;</span>, <span class="string">&#x27;friends&#x27;</span>, <span class="string">&#x27;private&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;private&#x27;</span> COMMENT <span class="string">&#x27;å¯è§æ€§ï¼šå…¬å¼€/ä»…å¥½å‹/ä»…è‡ªå·±&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_user_field` (`user_id`, `field`)  <span class="comment">-- ä¸€ä¸ªç”¨æˆ·çš„åŒä¸€ä¸ªå­—æ®µåªèƒ½æœ‰ä¸€æ¡è®¾ç½®</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·éšç§è®¾ç½®è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>ç”¨æˆ·Aè®¾ç½®æ‰‹æœºå·ä¸º <code>private</code>ï¼ˆä»…è‡ªå·±å¯è§ï¼‰</li>
<li>ç”¨æˆ·Bè®¾ç½®ç”Ÿæ—¥ä¸º <code>friends</code>ï¼ˆä»…å¥½å‹å¯è§ï¼‰</li>
<li>ç”¨æˆ·Cè®¾ç½®ä¸ªäººèµ„æ–™ä¸º <code>public</code>ï¼ˆæ‰€æœ‰äººå¯è§ï¼‰</li>
</ul>
<h2 id="ä¸‰ã€æ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–"><a href="#ä¸‰ã€æ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–" class="headerlink" title="ä¸‰ã€æ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–"></a>ä¸‰ã€æ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–</h2><h3 id="1-ç™»å½•æ€§èƒ½ä¼˜åŒ–"><a href="#1-ç™»å½•æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="1. ç™»å½•æ€§èƒ½ä¼˜åŒ–"></a>1. ç™»å½•æ€§èƒ½ä¼˜åŒ–</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šç™»å½•æ˜¯ç”¨æˆ·æœ€å¸¸ç”¨çš„åŠŸèƒ½ï¼Œå¦‚æœæ¯æ¬¡ç™»å½•éƒ½è¦ç­‰å¾ˆä¹…ï¼Œç”¨æˆ·ä½“éªŒä¼šå¾ˆå·®ã€‚åˆšå¼€å§‹æˆ‘çš„è¡¨æ²¡æœ‰å»ºç´¢å¼•ï¼Œç™»å½•æ—¶æ•°æ®åº“è¦æ‰«ææ•´ä¸ªè¡¨ï¼Œç‰¹åˆ«æ…¢ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>å»ºç´¢å¼•</strong>ï¼šç»™é‚®ç®±ã€æ‰‹æœºå·è¿™äº›ç™»å½•å­—æ®µå»ºç´¢å¼•ï¼Œå°±åƒç»™ä¹¦åŠ ç›®å½•ï¼ŒæŸ¥èµ·æ¥å¿«å¾ˆå¤š</li>
<li><strong>ç”¨ç¼“å­˜</strong>ï¼šç™»å½•æˆåŠŸåæŠŠç”¨æˆ·ä¿¡æ¯å­˜åˆ° Redisï¼Œä¸‹æ¬¡æŸ¥è¯¢ç›´æ¥ä»ç¼“å­˜å–ï¼Œä¸ç”¨æŸ¥æ•°æ®åº“</li>
<li><strong>è®°å½•ç™»å½•æ—¥å¿—</strong>ï¼šè®°å½•æ¯æ¬¡ç™»å½•çš„ä¿¡æ¯ï¼Œæ–¹ä¾¿ä»¥ååˆ†æï¼ˆæ¯”å¦‚å‘ç°å¼‚å¸¸ç™»å½•ï¼‰</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ç™»å½•æ—¥å¿—è¡¨ï¼ˆè®°å½•æ¯æ¬¡ç™»å½•çš„ä¿¡æ¯ï¼Œæ–¹ä¾¿ä»¥ååˆ†æï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `user_login_log` (</span><br><span class="line">  `log_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `login_time` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ç™»å½•æ—¶é—´&#x27;</span>,</span><br><span class="line">  `ip_address` <span class="type">VARCHAR</span>(<span class="number">45</span>) COMMENT <span class="string">&#x27;IPåœ°å€ï¼ˆå¯ä»¥ç”¨æ¥å‘ç°å¼‚å¸¸ç™»å½•ï¼‰&#x27;</span>,</span><br><span class="line">  `user_agent` TEXT COMMENT <span class="string">&#x27;å®¢æˆ·ç«¯ä¿¡æ¯ï¼ˆç”¨çš„ä»€ä¹ˆæµè§ˆå™¨ã€ä»€ä¹ˆè®¾å¤‡ï¼‰&#x27;</span>,</span><br><span class="line">  `login_result` ENUM(<span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;fail&#x27;</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;ç™»å½•ç»“æœï¼šæˆåŠŸ/å¤±è´¥&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  INDEX `idx_user_time` (`user_id`, `login_time`)  <span class="comment">-- æŒ‰ç”¨æˆ·å’Œæ—¶é—´æŸ¥æ—¥å¿—æ—¶ç”¨</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·ç™»å½•æ—¥å¿—è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>åŸºäº Redis çš„ Token æ–¹æ¡ˆ</strong>ï¼ˆå¦‚æœè¿˜æ²¡å­¦ Redisï¼Œå¯ä»¥å…ˆè·³è¿‡è¿™éƒ¨åˆ†ï¼‰ï¼š</p>
<p>æˆ‘ä½¿ç”¨äº†åŸºäº Redis çš„ Token æ–¹æ¡ˆæ¥ç®¡ç†ç™»å½•æ€ï¼ˆè¯¦ç»†å®ç°è§<a href="/2024/11/20/2024-11-20-login-session/">ã€Šç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 2ï¼šç™»å½•æ€ç®¡ç†çš„é‚£äº›å‘ã€‹</a>ï¼‰ã€‚è¿™ä¸ªæ–¹æ¡ˆä¸ä»…èƒ½ç¼“å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œè¿˜èƒ½è§£å†³å¤šç«¯ç™»å½•ã€æœåŠ¡é‡å¯ç­‰é—®é¢˜ã€‚</p>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼š</p>
<ul>
<li>ç™»å½•æˆåŠŸåç”Ÿæˆ Tokenï¼ŒæŠŠç”¨æˆ·ä¿¡æ¯ï¼ˆè„±æ•åçš„ <code>UserDTO</code>ï¼‰å­˜åˆ° Redis</li>
<li>Token ä½œä¸º Keyï¼Œç”¨æˆ·ä¿¡æ¯ä½œä¸º Valueï¼Œè®¾ç½® 2 å°æ—¶è¿‡æœŸæ—¶é—´</li>
<li>æ¯æ¬¡éªŒè¯ Token æ—¶è‡ªåŠ¨ç»­æœŸï¼Œç”¨æˆ·åªè¦æ´»è·ƒå°±ä¸ä¼šè¢«è¸¢ä¸‹çº¿</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenUtils</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”Ÿæˆ Tokenï¼ˆæ ¼å¼ï¼šUSER_TOKEN:éšæœºUUIDï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">generateToken</span><span class="params">(Long userId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;USER_TOKEN:&quot;</span> + UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨ Token å’Œç”¨æˆ·ä¿¡æ¯åˆ° Redisï¼ˆ2å°æ—¶è¿‡æœŸï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">storeToken</span><span class="params">(String token, UserDTO user)</span> &#123;</span><br><span class="line">        redisTemplate.opsForValue().set(token,</span><br><span class="line">                JSON.toJSONString(user),  <span class="comment">// å­˜å‚¨è„±æ•åçš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">                <span class="number">2</span>,</span><br><span class="line">                TimeUnit.HOURS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éªŒè¯ Token å¹¶è‡ªåŠ¨ç»­æœŸ</span></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">verifyToken</span><span class="params">(String token)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userJson</span> <span class="operator">=</span> redisTemplate.opsForValue().get(token);</span><br><span class="line">        <span class="keyword">if</span> (userJson == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// Token ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// éªŒè¯æˆåŠŸåè‡ªåŠ¨ç»­æœŸï¼ˆåˆ·æ–°è¿‡æœŸæ—¶é—´ä¸º2å°æ—¶ï¼‰</span></span><br><span class="line">        redisTemplate.expire(token, <span class="number">2</span>, TimeUnit.HOURS);</span><br><span class="line">        <span class="keyword">return</span> JSON.parseObject(userJson, UserDTO.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸ºä»€ä¹ˆç”¨ Redis è€Œä¸æ˜¯æ•°æ®åº“ï¼Ÿ</strong></p>
<ul>
<li><strong>æ€§èƒ½</strong>ï¼šRedis æ˜¯å†…å­˜æ•°æ®åº“ï¼ŒæŸ¥è¯¢é€Ÿåº¦æ¯” MySQL å¿«å¾ˆå¤š</li>
<li><strong>åˆ†å¸ƒå¼æ”¯æŒ</strong>ï¼šå¤šä¸ªæœåŠ¡å®ä¾‹å¯ä»¥å…±äº«åŒä¸€ä¸ª Redisï¼Œå®ç°å¤šç«¯ç™»å½•</li>
<li><strong>è‡ªåŠ¨è¿‡æœŸ</strong>ï¼šRedis æ”¯æŒè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ŒToken åˆ°æœŸè‡ªåŠ¨åˆ é™¤ï¼Œä¸ç”¨æ‰‹åŠ¨æ¸…ç†</li>
<li><strong>å‡è½»æ•°æ®åº“å‹åŠ›</strong>ï¼šç™»å½•æ€éªŒè¯æ˜¯é«˜é¢‘æ“ä½œï¼Œç”¨ Redis å¯ä»¥å¤§å¤§å‡å°‘æ•°æ®åº“æŸ¥è¯¢</li>
</ul>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>å­˜å‚¨çš„æ˜¯ <code>UserDTO</code>ï¼ˆè„±æ•åçš„ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼Œä¸è¦å­˜å®Œæ•´çš„ <code>User</code> å¯¹è±¡ï¼ˆé¿å…æ³„éœ²å¯†ç å“ˆå¸Œç­‰æ•æ„Ÿä¿¡æ¯ï¼‰</li>
<li>Token éªŒè¯æˆåŠŸåè¦è‡ªåŠ¨ç»­æœŸï¼Œè¿™æ ·ç”¨æˆ·åªè¦æ´»è·ƒå°±ä¸ä¼šè¢«è¸¢ä¸‹çº¿</li>
<li>å¦‚æœç”¨æˆ·åœ¨å…¶ä»–è®¾å¤‡ç™»å½•ï¼Œå¯ä»¥è®©æ—§ Token å¤±æ•ˆï¼ˆå®ç°å•ç‚¹ç™»å½•ï¼‰</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ç™»å½•æ—¥å¿—ï¼Ÿ</strong></p>
<ul>
<li>å¯ä»¥åˆ†æç”¨æˆ·ç™»å½•ä¹ æƒ¯ï¼ˆæ¯”å¦‚ä»€ä¹ˆæ—¶é—´ç™»å½•æœ€å¤šï¼‰</li>
<li>å‘ç°å¼‚å¸¸ç™»å½•ï¼ˆæ¯”å¦‚åŒä¸€ä¸ªè´¦å·åœ¨ä¸åŒåŸå¸‚ç™»å½•ï¼‰</li>
<li>å¦‚æœè´¦å·è¢«ç›—ï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—è¿½è¸ª</li>
</ul>
<h3 id="2-å¯†ç å®‰å…¨å­˜å‚¨"><a href="#2-å¯†ç å®‰å…¨å­˜å‚¨" class="headerlink" title="2. å¯†ç å®‰å…¨å­˜å‚¨"></a>2. å¯†ç å®‰å…¨å­˜å‚¨</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šè¿™æ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ï¼å¯†ç ç»å¯¹ä¸èƒ½æ˜æ–‡å­˜å‚¨ã€‚å¦‚æœæ•°æ®åº“è¢«æ³„éœ²ï¼Œæ˜æ–‡å¯†ç ä¼šè®©æ‰€æœ‰ç”¨æˆ·è´¦å·éƒ½æš´éœ²ã€‚å³ä½¿æ˜¯ç”¨ MD5 ç®€å•å“ˆå¸Œä¹Ÿä¸å®‰å…¨ï¼Œå› ä¸º MD5 å·²ç»è¢«ç ´è§£äº†ï¼Œå¾ˆå®¹æ˜“è¢«æš´åŠ›ç ´è§£ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>ä½¿ç”¨ bcrypt å“ˆå¸Œ</strong>ï¼šè¿™æ˜¯ç›®å‰æœ€å®‰å…¨çš„å¯†ç å­˜å‚¨æ–¹å¼ï¼ˆæ³¨æ„ï¼šæ˜¯å“ˆå¸Œä¸æ˜¯åŠ å¯†ï¼Œå“ˆå¸Œæ˜¯ä¸å¯é€†çš„ï¼‰</li>
<li><strong>æ°¸è¿œä¸å­˜æ˜æ–‡</strong>ï¼šå¯†ç ç»è¿‡å“ˆå¸Œåï¼Œå°±æ°¸è¿œä¸èƒ½è¿˜åŸæˆåŸå§‹å¯†ç ï¼ˆè¿™æ˜¯å¥½äº‹ï¼ï¼‰</li>
<li><strong>å¯†ç å¼ºåº¦æ ¡éªŒ</strong>ï¼šè¦æ±‚ç”¨æˆ·è®¾ç½®å¼ºå¯†ç ï¼ˆè‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—ï¼‰</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- å¯†ç å†å²è¡¨ï¼ˆé˜²æ­¢ç”¨æˆ·æ”¹å¯†ç æ—¶ï¼Œåˆæ”¹å›ä¹‹å‰ç”¨è¿‡çš„å¯†ç ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `user_password_history` (</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `password_hash` <span class="type">CHAR</span>(<span class="number">60</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;å†å²å¯†ç çš„å“ˆå¸Œå€¼&#x27;</span>,</span><br><span class="line">  `created_at` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä½¿ç”¨è¿™ä¸ªå¯†ç çš„æ—¶é—´&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  INDEX `idx_user_id` (`user_id`)</span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·å¯†ç å†å²è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å¯†ç å†å²è¡¨ï¼Ÿ</strong></p>
<ul>
<li>é˜²æ­¢ç”¨æˆ·æ”¹å¯†ç æ—¶ï¼Œåˆæ”¹å›ä¹‹å‰ç”¨è¿‡çš„æ—§å¯†ç ï¼ˆä¸å®‰å…¨ï¼‰</li>
<li>å¯ä»¥è®¾ç½®è§„åˆ™ï¼šæ–°å¯†ç ä¸èƒ½å’Œæœ€è¿‘2æ¬¡ç”¨è¿‡çš„å¯†ç ç›¸åŒ</li>
</ul>
<p><strong>bcrypt çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å“ˆå¸Œåçš„å¯†ç å›ºå®šæ˜¯ 60 ä¸ªå­—ç¬¦</li>
<li>æ¯æ¬¡å“ˆå¸ŒåŒä¸€ä¸ªå¯†ç ï¼Œç»“æœéƒ½ä¸ä¸€æ ·ï¼ˆä½†éªŒè¯æ—¶èƒ½æ­£ç¡®åŒ¹é…ï¼‰</li>
<li>ç ´è§£éš¾åº¦æé«˜ï¼Œæ˜¯ç›®å‰æœ€å®‰å…¨çš„å¯†ç å­˜å‚¨æ–¹å¼</li>
</ul>
<h2 id="å››ã€å¸¸è§ä¸šåŠ¡åœºæ™¯è§£å†³æ–¹æ¡ˆ"><a href="#å››ã€å¸¸è§ä¸šåŠ¡åœºæ™¯è§£å†³æ–¹æ¡ˆ" class="headerlink" title="å››ã€å¸¸è§ä¸šåŠ¡åœºæ™¯è§£å†³æ–¹æ¡ˆ"></a>å››ã€å¸¸è§ä¸šåŠ¡åœºæ™¯è§£å†³æ–¹æ¡ˆ</h2><h3 id="1-ç”¨æˆ·çŠ¶æ€ç®¡ç†"><a href="#1-ç”¨æˆ·çŠ¶æ€ç®¡ç†" class="headerlink" title="1. ç”¨æˆ·çŠ¶æ€ç®¡ç†"></a>1. ç”¨æˆ·çŠ¶æ€ç®¡ç†</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šç”¨æˆ·å¯èƒ½æœ‰ä¸åŒçš„çŠ¶æ€ï¼šåˆšæ³¨å†Œè¿˜æ²¡æ¿€æ´»ã€æ­£å¸¸ä½¿ç”¨ã€è¢«å°ç¦ã€å·²æ³¨é”€ã€‚éœ€è¦ç”¨ä¸€ä¸ªå­—æ®µæ¥è®°å½•è¿™äº›çŠ¶æ€ï¼Œè€Œä¸”è¦ä¿è¯çŠ¶æ€åˆ‡æ¢æ˜¯å®‰å…¨çš„ï¼ˆæ¯”å¦‚ä¸èƒ½éšä¾¿å°ç¦ç”¨æˆ·ï¼‰ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>ç”¨ ENUM é™åˆ¶çŠ¶æ€å€¼</strong>ï¼šåªèƒ½é€‰æ‹©é¢„è®¾çš„å‡ ä¸ªçŠ¶æ€ï¼Œä¸èƒ½éšä¾¿å¡«</li>
<li><strong>è®°å½•çŠ¶æ€å˜æ›´æ—¥å¿—</strong>ï¼šè°åœ¨ä»€ä¹ˆæ—¶å€™æŠŠç”¨æˆ·çŠ¶æ€æ”¹æˆäº†ä»€ä¹ˆï¼Œéƒ½è¦è®°å½•ä¸‹æ¥</li>
<li><strong>æ³¨é”€ç”¨é€»è¾‘åˆ é™¤</strong>ï¼šç”¨æˆ·æ³¨é”€æ—¶ï¼Œä¸ç›´æ¥åˆ é™¤æ•°æ®ï¼Œè€Œæ˜¯æ ‡è®°ä¸ºâ€å·²åˆ é™¤â€ï¼Œè¿™æ ·æ•°æ®è¿˜èƒ½æ¢å¤</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- åœ¨ç”¨æˆ·è¡¨æ·»åŠ çŠ¶æ€å­—æ®µ</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> `<span class="keyword">user</span>` <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> `status` ENUM(<span class="string">&#x27;pending&#x27;</span>, <span class="string">&#x27;active&#x27;</span>, <span class="string">&#x27;banned&#x27;</span>, <span class="string">&#x27;deleted&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;pending&#x27;</span>;</span><br><span class="line"><span class="comment">-- pending: å¾…æ¿€æ´»ï¼ˆåˆšæ³¨å†Œï¼Œè¿˜æ²¡éªŒè¯é‚®ç®±/æ‰‹æœºï¼‰</span></span><br><span class="line"><span class="comment">-- active: æ­£å¸¸ä½¿ç”¨</span></span><br><span class="line"><span class="comment">-- banned: è¢«å°ç¦ï¼ˆè¿è§„äº†ï¼‰</span></span><br><span class="line"><span class="comment">-- deleted: å·²æ³¨é”€ï¼ˆç”¨æˆ·è‡ªå·±æ³¨é”€çš„ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- çŠ¶æ€å˜æ›´æ—¥å¿—ï¼ˆè®°å½•æ¯æ¬¡çŠ¶æ€å˜åŒ–ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `user_status_log` (</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `old_status` ENUM(<span class="string">&#x27;pending&#x27;</span>, <span class="string">&#x27;active&#x27;</span>, <span class="string">&#x27;banned&#x27;</span>, <span class="string">&#x27;deleted&#x27;</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;æ—§çŠ¶æ€&#x27;</span>,</span><br><span class="line">  `new_status` ENUM(<span class="string">&#x27;pending&#x27;</span>, <span class="string">&#x27;active&#x27;</span>, <span class="string">&#x27;banned&#x27;</span>, <span class="string">&#x27;deleted&#x27;</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;æ–°çŠ¶æ€&#x27;</span>,</span><br><span class="line">  `operated_by` <span class="type">INT</span> COMMENT <span class="string">&#x27;æ“ä½œäººIDï¼ˆå“ªä¸ªç®¡ç†å‘˜æ“ä½œçš„ï¼‰&#x27;</span>,</span><br><span class="line">  `operate_time` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;æ“ä½œæ—¶é—´&#x27;</span>,</span><br><span class="line">  `reason` TEXT COMMENT <span class="string">&#x27;å˜æ›´åŸå› ï¼ˆä¸ºä»€ä¹ˆè¦å°ç¦è¿™ä¸ªç”¨æˆ·ï¼‰&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·çŠ¶æ€å˜æ›´æ—¥å¿—&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸ºä»€ä¹ˆè¦è®°å½•æ—¥å¿—ï¼Ÿ</strong></p>
<ul>
<li>å¦‚æœç®¡ç†å‘˜è¯¯æ“ä½œï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—æ¢å¤</li>
<li>å¦‚æœç”¨æˆ·ç”³è¯‰ï¼Œå¯ä»¥æŸ¥çœ‹å†å²è®°å½•</li>
<li>æ–¹ä¾¿å®¡è®¡ï¼ŒçŸ¥é“è°åœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆæ“ä½œ</li>
</ul>
<h3 id="2-æƒé™ä¸è§’è‰²ç®¡ç†"><a href="#2-æƒé™ä¸è§’è‰²ç®¡ç†" class="headerlink" title="2. æƒé™ä¸è§’è‰²ç®¡ç†"></a>2. æƒé™ä¸è§’è‰²ç®¡ç†</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šå¦‚æœç³»ç»Ÿæœ‰ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ã€VIP ç”¨æˆ·ç­‰ä¸åŒè§’è‰²ï¼Œæ¯ä¸ªè§’è‰²èƒ½åšçš„äº‹æƒ…ä¸ä¸€æ ·ã€‚å¦‚æœç»™æ¯ä¸ªç”¨æˆ·å•ç‹¬è®¾ç½®æƒé™ï¼Œä¼šå¾ˆéº»çƒ¦ã€‚æ¯”å¦‚æœ‰ 1000 ä¸ªæ™®é€šç”¨æˆ·ï¼Œéš¾é“è¦è®¾ç½® 1000 æ¬¡å—ï¼Ÿ</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé‡‡ç”¨ RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰æ¨¡å‹ã€‚ç®€å•è¯´å°±æ˜¯ï¼šå…ˆå®šä¹‰è§’è‰²ï¼ˆç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ï¼‰ï¼Œå†ç»™è§’è‰²åˆ†é…æƒé™ï¼Œæœ€åæŠŠç”¨æˆ·åˆ†é…ç»™è§’è‰²ã€‚è¿™æ ·ç®¡ç†èµ·æ¥æ–¹ä¾¿å¾ˆå¤šã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- è§’è‰²è¡¨ï¼ˆå®šä¹‰æœ‰å“ªäº›è§’è‰²ï¼šç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ã€VIPç­‰ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `role` (</span><br><span class="line">  `role_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `role_name` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;è§’è‰²åç§°&#x27;</span>,</span><br><span class="line">  `description` TEXT COMMENT <span class="string">&#x27;è§’è‰²æè¿°&#x27;</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;è§’è‰²è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç”¨æˆ·è§’è‰²å…³è”è¡¨ï¼ˆå“ªä¸ªç”¨æˆ·å±äºå“ªä¸ªè§’è‰²ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `user_role` (</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `role_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`user_id`) <span class="keyword">REFERENCES</span> `<span class="keyword">user</span>`(`user_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`role_id`) <span class="keyword">REFERENCES</span> `role`(`role_id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_user_role` (`user_id`, `role_id`)  <span class="comment">-- ä¸€ä¸ªç”¨æˆ·ä¸èƒ½é‡å¤åˆ†é…åŒä¸€ä¸ªè§’è‰²</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·è§’è‰²å…³è”è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æƒé™è¡¨ï¼ˆå®šä¹‰æœ‰å“ªäº›æƒé™ï¼šåˆ é™¤æ–‡ç« ã€å°ç¦ç”¨æˆ·ç­‰ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `permission` (</span><br><span class="line">  `perm_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `perm_code` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;æƒé™ä»£ç ï¼Œæ¯”å¦‚&quot;article:delete&quot;&#x27;</span>,</span><br><span class="line">  `description` TEXT COMMENT <span class="string">&#x27;æƒé™æè¿°&#x27;</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;æƒé™è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- è§’è‰²æƒé™å…³è”è¡¨ï¼ˆå“ªä¸ªè§’è‰²æœ‰å“ªäº›æƒé™ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `role_permission` (</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  `role_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `perm_id` <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`role_id`) <span class="keyword">REFERENCES</span> `role`(`role_id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">  <span class="keyword">FOREIGN KEY</span> (`perm_id`) <span class="keyword">REFERENCES</span> `permission`(`perm_id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_role_perm` (`role_id`, `perm_id`)  <span class="comment">-- ä¸€ä¸ªè§’è‰²ä¸èƒ½é‡å¤åˆ†é…åŒä¸€ä¸ªæƒé™</span></span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;è§’è‰²æƒé™å…³è”è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ol>
<li>åˆ›å»ºè§’è‰²ï¼šç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·</li>
<li>ç»™ç®¡ç†å‘˜åˆ†é…æƒé™ï¼šåˆ é™¤æ–‡ç« ã€å°ç¦ç”¨æˆ·ã€æŸ¥çœ‹æ‰€æœ‰æ•°æ®</li>
<li>ç»™æ™®é€šç”¨æˆ·åˆ†é…æƒé™ï¼šå‘å¸ƒæ–‡ç« ã€è¯„è®º</li>
<li>æŠŠç”¨æˆ·Aåˆ†é…ç»™â€ç®¡ç†å‘˜â€è§’è‰²ï¼Œç”¨æˆ·Båˆ†é…ç»™â€æ™®é€šç”¨æˆ·â€è§’è‰²</li>
</ol>
<p>è¿™æ ·ï¼Œç”¨æˆ·Aè‡ªåŠ¨æ‹¥æœ‰ç®¡ç†å‘˜çš„æƒé™ï¼Œç”¨æˆ·Bè‡ªåŠ¨æ‹¥æœ‰æ™®é€šç”¨æˆ·çš„æƒé™ã€‚å¦‚æœä»¥åè¦ç»™æ™®é€šç”¨æˆ·å¢åŠ æ–°æƒé™ï¼Œåªéœ€è¦åœ¨ <code>role_permission</code> è¡¨é‡ŒåŠ ä¸€æ¡è®°å½•ï¼Œæ‰€æœ‰æ™®é€šç”¨æˆ·å°±éƒ½æœ‰è¿™ä¸ªæƒé™äº†ã€‚</p>
<h2 id="äº”ã€è®¾è®¡åŸåˆ™æ€»ç»“"><a href="#äº”ã€è®¾è®¡åŸåˆ™æ€»ç»“" class="headerlink" title="äº”ã€è®¾è®¡åŸåˆ™æ€»ç»“"></a>äº”ã€è®¾è®¡åŸåˆ™æ€»ç»“</h2><p>ä½œä¸ºåˆå­¦è€…ï¼Œæˆ‘æ€»ç»“äº†å‡ ä¸ªé‡è¦çš„è®¾è®¡åŸåˆ™ï¼ˆä¸çŸ¥é“æœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ QAQï¼š</p>
<ol>
<li><strong>å®‰å…¨æ€§ä¼˜å…ˆ</strong>ï¼šå¯†ç å¿…é¡»å“ˆå¸Œå­˜å‚¨ï¼ˆç”¨ bcryptï¼‰ï¼Œæ•æ„Ÿä¿¡æ¯è¦è„±æ•ï¼Œé‡è¦æ“ä½œè¦è®°å½•æ—¥å¿—</li>
<li><strong>ä¸è¦è¿‡åº¦è®¾è®¡</strong>ï¼šåˆšå¼€å§‹ä¸éœ€è¦è€ƒè™‘å¤ªå¤šï¼Œå…ˆå®ç°åŸºæœ¬åŠŸèƒ½ï¼Œç­‰çœŸæ­£é‡åˆ°é—®é¢˜å†ä¼˜åŒ–</li>
<li><strong>åˆ†è¡¨å­˜å‚¨</strong>ï¼šæ ¸å¿ƒä¿¡æ¯ï¼ˆç™»å½•ç”¨çš„ï¼‰å’Œæ‰©å±•ä¿¡æ¯ï¼ˆä¸ªäººèµ„æ–™ï¼‰åˆ†å¼€ï¼Œè¿™æ ·æŸ¥è¯¢æ›´å¿«</li>
<li><strong>åˆç†å»ºç´¢å¼•</strong>ï¼šç»™ç»å¸¸æŸ¥è¯¢çš„å­—æ®µï¼ˆé‚®ç®±ã€æ‰‹æœºå·ï¼‰å»ºç´¢å¼•ï¼Œä½†ä¸è¦å»ºå¤ªå¤šï¼ˆä¼šå½±å“å†™å…¥æ€§èƒ½ï¼‰</li>
<li><strong>é¢„ç•™æ‰©å±•ç©ºé—´</strong>ï¼šè®¾è®¡æ—¶æƒ³æƒ³ä»¥åå¯èƒ½ä¼šåŠ ä»€ä¹ˆåŠŸèƒ½ï¼Œä½†ä¸è¦æƒ³å¤ªå¤šï¼ˆå®¹æ˜“è¿‡åº¦è®¾è®¡ï¼‰</li>
<li><strong>ä¿è¯æ•°æ®ä¸€è‡´æ€§</strong>ï¼šç”¨å¤–é”®ã€å”¯ä¸€ç´¢å¼•ã€äº‹åŠ¡æ¥ä¿è¯æ•°æ®ä¸ä¼šå‡ºé”™</li>
</ol>
<hr>
<h2 id="å…­ã€å­¦ä¹ æ„Ÿæƒ³"><a href="#å…­ã€å­¦ä¹ æ„Ÿæƒ³" class="headerlink" title="å…­ã€å­¦ä¹ æ„Ÿæƒ³"></a>å…­ã€å­¦ä¹ æ„Ÿæƒ³</h2><p>æˆ‘åœ¨å­¦ä¹ æ•°æ®åº“è®¾è®¡çš„è¿‡ç¨‹ä¸­è¸©äº†ä¸å°‘å‘ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šã€‚æƒ³å’Œå¤§å®¶åˆ†äº«å‡ ç‚¹æ„Ÿå—ï¼š</p>
<p><strong>1. ç†è®ºå¾ˆé‡è¦ï¼Œä½†å®è·µæ›´å…³é”®</strong></p>
<p>åˆšå¼€å§‹æˆ‘çœ‹äº†å¾ˆå¤šæ•°æ®åº“è®¾è®¡çš„ç†è®ºï¼Œä½†çœŸæ­£åŠ¨æ‰‹è®¾è®¡æ—¶æ‰å‘ç°ï¼Œç†è®ºå’Œå®é™…å·®è·å¾ˆå¤§ã€‚æ¯”å¦‚ä¹¦ä¸Šè¯´â€è¦é¿å…è¿‡åº¦è®¾è®¡â€ï¼Œä½†æ€ä¹ˆåˆ¤æ–­æ˜¯ä¸æ˜¯â€è¿‡åº¦â€ï¼Ÿåªæœ‰çœŸæ­£åšäº†é¡¹ç›®ï¼Œé‡åˆ°é—®é¢˜ï¼Œæ‰èƒ½ç†è§£ã€‚</p>
<p><strong>2. ä»ç®€å•å¼€å§‹ï¼Œé€æ­¥ä¼˜åŒ–</strong></p>
<p>æˆ‘åˆšå¼€å§‹æƒ³æŠŠæ‰€æœ‰åŠŸèƒ½éƒ½è®¾è®¡å¥½ï¼Œç»“æœè¡¨è®¾è®¡å¾—ç‰¹åˆ«å¤æ‚ï¼Œåæ¥å‘ç°å¾ˆå¤šåŠŸèƒ½æ ¹æœ¬ç”¨ä¸åˆ°ã€‚ç°åœ¨æˆ‘çš„åšæ³•æ˜¯ï¼šå…ˆè®¾è®¡æœ€ç®€å•çš„ç‰ˆæœ¬ï¼Œèƒ½è·‘èµ·æ¥å°±è¡Œã€‚ç­‰çœŸæ­£éœ€è¦æŸä¸ªåŠŸèƒ½æ—¶ï¼Œå†åŠ å¯¹åº”çš„è¡¨æˆ–å­—æ®µã€‚</p>
<p><strong>3. å¤šæ€è€ƒï¼Œå¤šæ€»ç»“</strong></p>
<p>æ¯æ¬¡é‡åˆ°é—®é¢˜ï¼Œæˆ‘éƒ½ä¼šæƒ³ï¼šä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Ÿç„¶åè®°å½•ä¸‹æ¥ã€‚è¿™ç¯‡æ–‡ç« å°±æ˜¯æˆ‘å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ€»ç»“ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°åŒæ ·åœ¨å­¦ä¹ çš„æœ‹å‹ã€‚ï¼ˆä¸»è¦ä¹Ÿæ˜¯æœ‰ä¸ªåšå®¢èƒ½è®©æˆ‘ç£ä¿ƒè‡ªå·±å•¦</p>
<p>è¦æ˜¯ä½ ä¹Ÿæƒ³å»ºä¸€ä¸ªåšå®¢ï¼Œå’Œæˆ‘ä¸€æ ·è®°å½•è‡ªå·±çš„å­¦ä¹ ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„åšå®¢æ­å»ºæ–¹æ³•ï¼ˆè§<a href="/2024/11/21/2024-11-21-building-my-blog-with-hexo/">ã€Šä»é›¶å¼€å§‹æ­å»ºä¸ªäººåšå®¢ï¼šHexo + Butterfly ä¸»é¢˜å®è·µã€‹</a>ï¼‰</p>
<p><strong>4. ä¸è¦å®³æ€•çŠ¯é”™</strong></p>
<p>æˆ‘åœ¨è®¾è®¡è¿‡ç¨‹ä¸­çŠ¯äº†å¾ˆå¤šé”™è¯¯ï¼šè¡¨ç»“æ„ä¸åˆç†ã€å¿˜è®°å»ºç´¢å¼•ã€å¤–é”®è®¾ç½®é”™è¯¯â€¦ä½†æ¯æ¬¡çŠ¯é”™éƒ½æ˜¯ä¸€æ¬¡å­¦ä¹ çš„æœºä¼šã€‚ç°åœ¨å›å¤´çœ‹ï¼Œè¿™äº›é”™è¯¯è®©æˆ‘å¯¹æ•°æ®åº“æœ‰äº†æ›´æ·±çš„ç†è§£ã€‚</p>
<hr>
<p><strong>å†™åœ¨æœ€å</strong>ï¼š</p>
<p>æ•°æ®åº“è®¾è®¡æ˜¯ä¸€ä¸ªéœ€è¦ä¸æ–­å­¦ä¹ å’Œå®è·µçš„è¿‡ç¨‹ã€‚åˆšå¼€å§‹æˆ‘ä»¬ä¸éœ€è¦ä¸€å¼€å§‹å°±è®¾è®¡å‡ºå®Œç¾çš„ç³»ç»Ÿï¼Œåƒæˆ‘å¼€å§‹çš„æ—¶å€™ä¸€ç›´ä¸œæƒ³è¥¿æƒ³ï¼Œä½†åœ¨é¡¹ç›®å†™ç€å†™ç€çš„æ—¶å€™è¿˜æ˜¯é‡åˆ°äº†ä¸å°‘é—®é¢˜ï¼Œæ‰€ä»¥æœ€é‡è¦çš„è¿˜æ˜¯å…ˆå®è·µï¼Œå†ä»ä¸­ä¸æ–­æ”¹è¿›ã€‚å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæˆ–è€…ä½ å‘ç°äº†ä»€ä¹ˆé—®é¢˜ï¼Œæ¬¢è¿ä¸€èµ·äº¤æµè®¨è®ºï¼</p>
<p>å­¦ä¹ è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·åŠ æ²¹ï¼ğŸ’ª </p>
<p><strong>ä¸€äº›åºŸè¯</strong>ï¼š</p>
<p>å†™è¿™ç¯‡åšå®¢èŠ±è´¹äº†å¥½é•¿æ—¶é—´ï¼Œæ„Ÿè§‰å¥½å¤šä¸œè¥¿å­¦äº†ä¹Ÿç”¨äº†ï¼Œå´ä¸çŸ¥é“æ€ä¹ˆè¾“å‡ºç»™åˆ«äººçœ‹ï¼Œæ€ä¹ˆæ¢³ç†éƒ½è¿˜æ˜¯ä¸å¤Ÿå¥½ï¼Œä½†å°±è¿™æ ·å§ å®åœ¨å†™ä¸ä¸‹å»äº†ï¼Œæ„Ÿè§‰æ¯”åšé¡¹ç›®è¿˜è¦å‘½QAQ</p>
<hr>
<h2 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h2><p>è¿™ä¸ªç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ç³»åˆ—çš„å…¶ä»–æ–‡ç« ï¼š</p>
<ul>
<li><a href="/2024/11/15/2024-11-15-password-security/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 1ï¼šå¯†ç åŠ å¯†é‚£äº›äº‹å„¿</a></li>
<li><a href="/2024/11/20/2024-11-20-login-session/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 2ï¼šç™»å½•æ€ç®¡ç†çš„é‚£äº›å‘</a></li>
<li><a href="/2024/11/29/2024-11-29-user-center-project-summary/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®æ€»ç»“ï¼šä» 0 åˆ° 1 çš„å®Œæ•´å®è·µ</a></li>
</ul>
]]></content>
      <categories>
        <category>åç«¯å¼€å‘æ€è€ƒ</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
        <tag>ç”¨æˆ·ä¸­å¿ƒ</tag>
        <tag>Redis</tag>
        <tag>æ•°æ®åº“è®¾è®¡</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2024/11/03/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®æ€»ç»“ï¼šä» 0 åˆ° 1 çš„å®Œæ•´å®è·µ</title>
    <url>/2024/11/29/2024-11-29-user-center-project-summary/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘èŠ±äº†å¤§çº¦ 3 å‘¨æ—¶é—´å®Œæˆäº†æˆ‘çš„ç¬¬ä¸€ä¸ªå®Œæ•´åç«¯é¡¹ç›®â€”â€”ç”¨æˆ·ä¸­å¿ƒç³»ç»Ÿã€‚ä½œä¸ºä¸€ä¸ªå¤§äºŒå­¦ç”Ÿï¼Œè¿™ä¸ªé¡¹ç›®è®©æˆ‘ä»â€åªä¼šå†™ Hello Worldâ€åˆ°èƒ½å¤Ÿç‹¬ç«‹å®Œæˆä¸€ä¸ªå‰åç«¯åˆ†ç¦»çš„ç³»ç»Ÿã€‚è™½ç„¶é¡¹ç›®è¿˜æ²¡éƒ¨ç½²ï¼Œä»£ç ä¹Ÿè¿˜æœ‰å¾ˆå¤šå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹è®©æˆ‘å­¦åˆ°äº†å¾ˆå¤šã€‚ä»Šå¤©æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªé¡¹ç›®ï¼Œä»¥åŠæ•´ä¸ªå¼€å‘è¿‡ç¨‹ä¸­çš„æ€è€ƒå’Œæ”¶è·ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ï¼Ÿ"></a>ä¸ºä»€ä¹ˆé€‰æ‹©ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ï¼Ÿ</h2><h3 id="1-ä»â€çœ‹åˆ°â€åˆ°â€æƒ³åšâ€"><a href="#1-ä»â€çœ‹åˆ°â€åˆ°â€æƒ³åšâ€" class="headerlink" title="1. ä»â€çœ‹åˆ°â€åˆ°â€æƒ³åšâ€"></a>1. ä»â€çœ‹åˆ°â€åˆ°â€æƒ³åšâ€</h3><p>å…¶å®æœ€å¼€å§‹æˆ‘å¹¶æ²¡æœ‰æ˜ç¡®çš„é¡¹ç›®æ–¹å‘ã€‚é‚£æ®µæ—¶é—´åœ¨ç½‘ä¸Šåˆ·åˆ°å¾ˆå¤šç±»ä¼¼çš„é¡¹ç›®æ•™ç¨‹ï¼Œæ¯”å¦‚â€ä»é›¶å¼€å§‹æ­å»ºç”¨æˆ·ç³»ç»Ÿâ€ã€â€Spring Boot å®æˆ˜é¡¹ç›®â€ä¹‹ç±»çš„ã€‚çœ‹å¤šäº†ä¹‹åï¼Œæˆ‘å‘ç°ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®æœ‰å‡ ä¸ªç‰¹ç‚¹ç‰¹åˆ«é€‚åˆæˆ‘è¿™ç§åˆå­¦è€…ï¼š</p>
<ul>
<li><strong>åŠŸèƒ½æ˜ç¡®</strong>ï¼šæ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ç®¡ç†ï¼Œè¿™äº›åŠŸèƒ½æˆ‘ä½œä¸ºç”¨æˆ·æ¯å¤©éƒ½åœ¨ç”¨ï¼Œç†è§£èµ·æ¥ä¸è´¹åŠ²</li>
<li><strong>æŠ€æœ¯æ ˆå¸¸è§</strong>ï¼šSpring Boot + MySQL + Redisï¼Œè¿™äº›æŠ€æœ¯ç½‘ä¸Šèµ„æ–™å¤šï¼Œé‡åˆ°é—®é¢˜å®¹æ˜“æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ</li>
<li><strong>å¤æ‚åº¦é€‚ä¸­</strong>ï¼šä¸ä¼šå¤ªç®€å•ï¼ˆæ¯”å¦‚åªåšä¸ªè®¡ç®—å™¨ï¼‰ï¼Œä¹Ÿä¸ä¼šå¤ªå¤æ‚ï¼ˆæ¯”å¦‚ç”µå•†ç³»ç»Ÿï¼‰ï¼Œæ­£å¥½é€‚åˆç»ƒæ‰‹</li>
</ul>
<p>æ‰€ä»¥æˆ‘å°±å†³å®šï¼šå°±åšè¿™ä¸ªäº†ï¼</p>
<h3 id="2-è½¯ä»¶å·¥ç¨‹å¯¼è®ºçš„å¯å‘"><a href="#2-è½¯ä»¶å·¥ç¨‹å¯¼è®ºçš„å¯å‘" class="headerlink" title="2. è½¯ä»¶å·¥ç¨‹å¯¼è®ºçš„å¯å‘"></a>2. è½¯ä»¶å·¥ç¨‹å¯¼è®ºçš„å¯å‘</h3><p>è¿™å­¦æœŸæˆ‘ä»¬å¼€äº†ã€Šè½¯ä»¶å·¥ç¨‹å¯¼è®ºã€‹è¿™é—¨è¯¾ï¼Œè™½ç„¶ç†è®ºå±…å¤šï¼Œä½†è®©æˆ‘çŸ¥é“äº†åšé¡¹ç›®ä¸æ˜¯ç›´æ¥å†™ä»£ç ï¼Œè€Œæ˜¯è¦å…ˆåˆ†æéœ€æ±‚ã€è®¾è®¡æ¶æ„ã€ç”»æ•°æ®åº“è¡¨ã€å®šä¹‰æ¥å£â€¦è¿™äº›æ­¥éª¤ã€‚</p>
<p>æ‰€ä»¥æˆ‘æƒ³æŒ‰ç…§è¯¾ç¨‹é‡Œå­¦åˆ°çš„æ–¹æ³•ï¼Œä¸€æ­¥æ­¥æ¥ï¼š</p>
<ol>
<li><strong>éœ€æ±‚åˆ†æ</strong>ï¼šå…ˆæƒ³æ¸…æ¥šè¦åšä»€ä¹ˆåŠŸèƒ½</li>
<li><strong>æŠ€æœ¯é€‰å‹</strong>ï¼šé€‰ä»€ä¹ˆæ¡†æ¶ã€ä»€ä¹ˆæ•°æ®åº“</li>
<li><strong>æ¶æ„è®¾è®¡</strong>ï¼šç³»ç»Ÿæ€ä¹ˆåˆ†å±‚ï¼Œæ¨¡å—æ€ä¹ˆåˆ’åˆ†</li>
<li><strong>æ•°æ®åº“è®¾è®¡</strong>ï¼šè¡¨ç»“æ„æ€ä¹ˆè®¾è®¡ï¼Œå­—æ®µæ€ä¹ˆå®šä¹‰</li>
<li><strong>API è®¾è®¡</strong>ï¼šæ¥å£è·¯å¾„ã€å‚æ•°ã€è¿”å›å€¼</li>
<li><strong>ç¼–ç å®ç°</strong>ï¼šæŠŠè®¾è®¡å˜æˆä»£ç </li>
<li><strong>æµ‹è¯•ä¼˜åŒ–</strong>ï¼šè·‘é€šåŠŸèƒ½ï¼Œä¼˜åŒ–æ€§èƒ½</li>
</ol>
<p>è™½ç„¶æœ€ååšçš„æ—¶å€™è¿˜æ˜¯è¸©äº†å¾ˆå¤šå‘ï¼Œä½†æœ‰äº†è¿™ä¸ªæ€è·¯ï¼Œè‡³å°‘ä¸ä¼šå®Œå…¨ä¸çŸ¥é“ä»å“ªå¼€å§‹ã€‚</p>
<h2 id="é¡¹ç›®æµç¨‹å›é¡¾"><a href="#é¡¹ç›®æµç¨‹å›é¡¾" class="headerlink" title="é¡¹ç›®æµç¨‹å›é¡¾"></a>é¡¹ç›®æµç¨‹å›é¡¾</h2><h3 id="1-éœ€æ±‚åˆ†æé˜¶æ®µ"><a href="#1-éœ€æ±‚åˆ†æé˜¶æ®µ" class="headerlink" title="1. éœ€æ±‚åˆ†æé˜¶æ®µ"></a>1. éœ€æ±‚åˆ†æé˜¶æ®µ</h3><p>æœ€å¼€å§‹æˆ‘èŠ±äº†ä¸¤å¤©æ—¶é—´æ¢³ç†éœ€æ±‚ã€‚è™½ç„¶ç”¨æˆ·ä¸­å¿ƒå¬èµ·æ¥ç®€å•ï¼Œä½†çœŸè¦å†™ä¸‹æ¥ï¼Œè¿˜æ˜¯æœ‰ä¸å°‘ç»†èŠ‚è¦è€ƒè™‘ï¼š</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li><strong>ç”¨æˆ·æ³¨å†Œ</strong>ï¼šè´¦æˆ·å¯†ç æ ¡éªŒã€é‡å¤æ£€æŸ¥ï¼ˆç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·ä¸èƒ½é‡å¤ï¼‰</li>
<li><strong>ç”¨æˆ·ç™»å½•</strong>ï¼šèº«ä»½éªŒè¯ã€ç™»å½•æ€ç®¡ç†ï¼ˆToken æœºåˆ¶ï¼‰</li>
<li><strong>ç”¨æˆ·ä¿¡æ¯ç®¡ç†</strong>ï¼šæŸ¥çœ‹ã€ä¿®æ”¹ä¸ªäººä¿¡æ¯</li>
<li><strong>ç”¨æˆ·ç®¡ç†</strong>ï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰ï¼šæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ã€ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ã€åˆ é™¤ç”¨æˆ·</li>
<li><strong>æƒé™æ§åˆ¶</strong>ï¼šåŒºåˆ†æ™®é€šç”¨æˆ·å’Œç®¡ç†å‘˜ï¼Œä¸åŒè§’è‰²èƒ½è®¿é—®çš„æ¥å£ä¸åŒ</li>
</ul>
<p><strong>éåŠŸèƒ½éœ€æ±‚</strong>ï¼š</p>
<ul>
<li>å¯†ç è¦åŠ å¯†å­˜å‚¨ï¼ˆä¸èƒ½æ˜æ–‡ï¼‰</li>
<li>ç™»å½•æ€è¦æ”¯æŒå¤šç«¯ï¼ˆPCã€æ‰‹æœºéƒ½èƒ½ç™»å½•ï¼‰</li>
<li>æ¥å£è¦ç»Ÿä¸€è¿”å›æ ¼å¼ï¼Œæ–¹ä¾¿å‰ç«¯å¤„ç†</li>
<li>å¼‚å¸¸è¦ç»Ÿä¸€å¤„ç†ï¼Œä¸èƒ½ç›´æ¥è¿”å›å †æ ˆä¿¡æ¯</li>
</ul>
<h3 id="2-æŠ€æœ¯é€‰å‹é˜¶æ®µ"><a href="#2-æŠ€æœ¯é€‰å‹é˜¶æ®µ" class="headerlink" title="2. æŠ€æœ¯é€‰å‹é˜¶æ®µ"></a>2. æŠ€æœ¯é€‰å‹é˜¶æ®µ</h3><p>é€‰æŠ€æœ¯çš„æ—¶å€™æˆ‘ä¸»è¦è€ƒè™‘ä¸¤ä¸ªå› ç´ ï¼š<strong>å­¦ä¹ æˆæœ¬</strong>å’Œ<strong>èµ„æ–™ä¸°å¯Œåº¦</strong>ã€‚æ¯•ç«Ÿæˆ‘æ˜¯è‡ªå­¦ï¼Œå¦‚æœè¿˜é€‰ä¸ªå†·é—¨æŠ€æœ¯ï¼Œé‡åˆ°é—®é¢˜æ‰¾ä¸åˆ°èµ„æ–™å°±å¾ˆéº»çƒ¦ã€‚</p>
<table>
<thead>
<tr>
<th>æ¨¡å—</th>
<th>æŠ€æœ¯é€‰æ‹©</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody><tr>
<td>åç«¯æ¡†æ¶</td>
<td>Spring Boot</td>
<td>ä¸Šæ‰‹å¿«ï¼Œç”Ÿæ€å®Œå–„ï¼Œç½‘ä¸Šæ•™ç¨‹å¤š</td>
</tr>
<tr>
<td>æ•°æ®åº“</td>
<td>MySQL</td>
<td>å…³ç³»å‹æ•°æ®åº“ï¼Œé€‚åˆå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œå­¦ä¹ æˆæœ¬ä½</td>
</tr>
<tr>
<td>ORM</td>
<td>MyBatis-Plus</td>
<td>ç®€åŒ– CRUD æ“ä½œï¼Œè‡ªåŠ¨ç”Ÿæˆä»£ç ï¼Œå‡å°‘é‡å¤å·¥ä½œ</td>
</tr>
<tr>
<td>ç™»å½•æ€ç®¡ç†</td>
<td>Redis + Token</td>
<td>æ”¯æŒåˆ†å¸ƒå¼ï¼Œå¯ä¸»åŠ¨å¤±æ•ˆï¼Œæ¯” Session çµæ´»</td>
</tr>
<tr>
<td>å‰ç«¯</td>
<td>React + Ant Design</td>
<td>ç»„ä»¶ä¸°å¯Œï¼Œé€‚åˆåšç®¡ç†ç³»ç»Ÿç•Œé¢</td>
</tr>
<tr>
<td>å¯†ç åŠ å¯†</td>
<td>BCrypt</td>
<td>å®‰å…¨æ€§é«˜ï¼ŒSpring Security å†…ç½®æ”¯æŒ</td>
</tr>
</tbody></table>
<h3 id="3-æ¶æ„è®¾è®¡é˜¶æ®µ"><a href="#3-æ¶æ„è®¾è®¡é˜¶æ®µ" class="headerlink" title="3. æ¶æ„è®¾è®¡é˜¶æ®µ"></a>3. æ¶æ„è®¾è®¡é˜¶æ®µ</h3><p>è™½ç„¶é¡¹ç›®ä¸å¤§ï¼Œä½†æˆ‘è¿˜æ˜¯ç®€å•ç”»äº†ä¸€ä¸‹æ¶æ„å›¾ï¼ˆç”¨ draw.io ç”»çš„ï¼Œæ¯”è¾ƒç®€å•ï¼‰ï¼š</p>
<p><img src="/img/ahzUserhub-archDiagram.png" alt="ç³»ç»Ÿæ¶æ„ç¤ºæ„å›¾"></p>
<p><strong>åˆ†å±‚è®¾è®¡</strong>ï¼š</p>
<ul>
<li><strong>Controller å±‚</strong>ï¼šæ¥æ”¶ HTTP è¯·æ±‚ï¼Œå‚æ•°æ ¡éªŒï¼Œè¿”å›ç»Ÿä¸€æ ¼å¼çš„å“åº”</li>
<li><strong>Service å±‚</strong>ï¼šä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œæ¯”å¦‚ç™»å½•éªŒè¯ã€å¯†ç åŠ å¯†ã€Token ç”Ÿæˆ</li>
<li><strong>Mapper å±‚</strong>ï¼šæ•°æ®åº“ CRUD æ“ä½œï¼Œä½¿ç”¨ MyBatis-Plus ç®€åŒ–</li>
</ul>
<p><strong>å…³é”®ç»„ä»¶</strong>ï¼š</p>
<ul>
<li><strong>æ‹¦æˆªå™¨</strong>ï¼šç»Ÿä¸€å¤„ç† Token éªŒè¯ã€æƒé™æ ¡éªŒ</li>
<li><strong>å…¨å±€å¼‚å¸¸å¤„ç†å™¨</strong>ï¼šç»Ÿä¸€å¤„ç†å¼‚å¸¸ï¼Œè¿”å›å‹å¥½é”™è¯¯ä¿¡æ¯</li>
<li><strong>å·¥å…·ç±»</strong>ï¼šToken ç”Ÿæˆã€å¯†ç åŠ å¯†ã€ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆThreadLocalï¼‰</li>
</ul>
<h3 id="4-æ•°æ®åº“è®¾è®¡é˜¶æ®µ"><a href="#4-æ•°æ®åº“è®¾è®¡é˜¶æ®µ" class="headerlink" title="4. æ•°æ®åº“è®¾è®¡é˜¶æ®µ"></a>4. æ•°æ®åº“è®¾è®¡é˜¶æ®µ</h3><p>æ•°æ®åº“è®¾è®¡æˆ‘èŠ±äº†ä¸å°‘æ—¶é—´ï¼Œå› ä¸ºè¿™æ˜¯ç¬¬ä¸€æ¬¡è‡ªå·±è®¾è®¡è¡¨ç»“æ„ã€‚æˆ‘å‚è€ƒäº†ä¸€äº›å¼€æºé¡¹ç›®çš„è®¾è®¡ï¼Œä¹Ÿçœ‹äº†å¾ˆå¤šæ•°æ®åº“è®¾è®¡çš„æ–‡ç« ï¼ˆåæ¥æˆ‘è¿˜ä¸“é—¨å†™äº†ä¸€ç¯‡<a href="/2024/11/26/2024-11-26-user-center-database-design/">ã€Šç”¨æˆ·ä¸­å¿ƒé¡¹ç›®çš„æ•°æ®åº“è®¾è®¡ï¼šå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆã€‹</a>æ¥æ€»ç»“ï¼‰ã€‚</p>
<p><strong>æ ¸å¿ƒè¡¨è®¾è®¡</strong>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ç”¨æˆ·è¡¨ï¼ˆæ ¸å¿ƒè¡¨ï¼‰</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">  `user_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ç”¨æˆ·ID&#x27;</span>,</span><br><span class="line">  `username` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">  `email` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">  `password_hash` <span class="type">CHAR</span>(<span class="number">60</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;å¯†ç å“ˆå¸Œ(bcrypt)&#x27;</span>,</span><br><span class="line">  `user_role` ENUM(<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;user&#x27;</span> COMMENT <span class="string">&#x27;è§’è‰²&#x27;</span>,</span><br><span class="line">  `status` ENUM(<span class="string">&#x27;active&#x27;</span>, <span class="string">&#x27;inactive&#x27;</span>, <span class="string">&#x27;banned&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;inactive&#x27;</span> COMMENT <span class="string">&#x27;çŠ¶æ€&#x27;</span>,</span><br><span class="line">  `created_at` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `updated_at` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">  `is_delete` TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;é€»è¾‘åˆ é™¤æ ‡è®°&#x27;</span>,</span><br><span class="line">  INDEX `idx_email` (`email`),</span><br><span class="line">  INDEX `idx_phone` (`phone`)</span><br><span class="line">) COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·åŸºæœ¬ä¿¡æ¯è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>è®¾è®¡è€ƒè™‘</strong>ï¼š</p>
<ul>
<li>ç”¨ <code>UNIQUE</code> ä¿è¯ç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·å”¯ä¸€</li>
<li>ç»™é‚®ç®±ã€æ‰‹æœºå·å»ºç´¢å¼•ï¼Œç™»å½•æ—¶æŸ¥è¯¢å¿«</li>
<li>ç”¨ <code>ENUM</code> é™åˆ¶è§’è‰²å’ŒçŠ¶æ€çš„å€¼ï¼Œé¿å…è„æ•°æ®</li>
<li>ç”¨é€»è¾‘åˆ é™¤ï¼ˆ<code>is_delete</code>ï¼‰è€Œä¸æ˜¯ç‰©ç†åˆ é™¤ï¼Œæ•°æ®å¯ä»¥æ¢å¤</li>
</ul>
<h3 id="5-API-è®¾è®¡é˜¶æ®µ"><a href="#5-API-è®¾è®¡é˜¶æ®µ" class="headerlink" title="5. API è®¾è®¡é˜¶æ®µ"></a>5. API è®¾è®¡é˜¶æ®µ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·ç›¸å…³æ¥å£ï¼š</span><br><span class="line">POST   /api/user/register          # ç”¨æˆ·æ³¨å†Œ</span><br><span class="line">POST   /api/user/login              # ç”¨æˆ·ç™»å½•</span><br><span class="line">GET    /api/user/getInfo            # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">POST   /api/user/updateInfo         # æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">POST   /api/user/logout             # é€€å‡ºç™»å½•</span><br><span class="line"></span><br><span class="line">ç®¡ç†å‘˜æ¥å£ï¼š</span><br><span class="line">GET    /api/admin/getUserList       # è·å–ç”¨æˆ·åˆ—è¡¨</span><br><span class="line">GET    /api/admin/getUserById       # è·å–ç”¨æˆ·è¯¦æƒ…</span><br><span class="line">POST   /api/admin/updateUser        # æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">POST   /api/admin/deleteUser        # åˆ é™¤ç”¨æˆ·</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨å›å¤´çœ‹ï¼Œæ¥å£è®¾è®¡ç¡®å®æœ‰å¾ˆå¤šé—®é¢˜ï¼š</p>
<ul>
<li><strong>è·¯å¾„å‘½åä¸ç»Ÿä¸€</strong>ï¼šæœ‰äº›ç”¨å±‚çº§ç»“æ„ï¼ˆ<code>/api/user/register</code>ï¼‰ï¼Œæœ‰äº›ç”¨åŠ¨è¯+åè¯ï¼ˆ<code>/api/admin/getUserList</code>ï¼‰</li>
<li><strong>HTTP æ–¹æ³•ç”¨å¾—ä¸å¯¹</strong>ï¼šæ›´æ–°å’Œåˆ é™¤åº”è¯¥ç”¨ PUT å’Œ DELETEï¼Œä½†æˆ‘éƒ½ç”¨ POST äº†</li>
<li><strong>å‚æ•°ä¼ é€’æ–¹å¼æ··ä¹±</strong>ï¼š<code>getUserById</code> ç”¨æŸ¥è¯¢å‚æ•°ä¼  IDï¼Œ<code>updateUser</code> å’Œ <code>deleteUser</code> åˆåœ¨è¯·æ±‚ä½“é‡Œä¼  userIdï¼Œä¸€ç‚¹éƒ½ä¸ç»Ÿä¸€</li>
<li><strong>GET è¯·æ±‚ä¼ å‚ä¸è§„èŒƒ</strong>ï¼š<code>getUserById</code> åº”è¯¥ç”¨è·¯å¾„å‚æ•° <code>/api/admin/user/&#123;id&#125;</code> æ›´è§„èŒƒ</li>
</ul>
<p>ä¸è¿‡å½“æ—¶èƒ½è·‘èµ·æ¥å°±è¡Œï¼Œåé¢æˆ‘åº”è¯¥ä¼šå†™ä¸€ç¯‡å…³äºå­¦åˆ°çš„ RESTful API è®¾è®¡æ–¹æ³•ã€‚</p>
<p><strong>ç»Ÿä¸€è¿”å›æ ¼å¼</strong>ï¼š<br>å”¯ä¸€åšå¾—æ¯”è¾ƒè§„èŒƒçš„æ˜¯ç»Ÿä¸€è¿”å›æ ¼å¼ï¼Œæ‰€æœ‰æ¥å£éƒ½è¿”å› <code>Result&lt;T&gt;</code> æ ¼å¼ï¼Œè¿™æ ·å‰ç«¯å¤„ç†èµ·æ¥æ–¹ä¾¿ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;code&quot;</span>: <span class="number">0</span>,           <span class="comment">// 0 è¡¨ç¤ºæˆåŠŸï¼Œé 0 è¡¨ç¤ºå¤±è´¥</span></span><br><span class="line">  <span class="string">&quot;data&quot;</span>: &#123;...&#125;,       <span class="comment">// æ•°æ®</span></span><br><span class="line">  <span class="string">&quot;message&quot;</span>: <span class="string">&quot;ok&quot;</span>      <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-å¼€å‘å®ç°é˜¶æ®µ"><a href="#6-å¼€å‘å®ç°é˜¶æ®µ" class="headerlink" title="6. å¼€å‘å®ç°é˜¶æ®µ"></a>6. å¼€å‘å®ç°é˜¶æ®µ</h3><p>è¿™ä¸ªé˜¶æ®µæ˜¯æœ€ç—›è‹¦çš„ï¼Œä¹Ÿæ˜¯æ”¶è·æœ€å¤šçš„ã€‚æˆ‘é‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œä¹Ÿè§£å†³äº†å¾ˆå¤šé—®é¢˜ï¼š</p>
<p><strong>é—®é¢˜ 1ï¼šå¯†ç å®‰å…¨å­˜å‚¨</strong></p>
<p>æœ€å¼€å§‹æˆ‘ç›´æ¥æŠŠå¯†ç å­˜åˆ°æ•°æ®åº“ï¼Œåæ¥æ„è¯†åˆ°å®‰å…¨é—®é¢˜ï¼Œæ”¹æˆäº† BCrypt åŠ å¯†ã€‚è¿™ä¸ªè¿‡ç¨‹æˆ‘ä¸“é—¨å†™äº†ä¸€ç¯‡æ–‡ç« è®°å½•ï¼ˆè§<a href="/2024/11/15/2024-11-15-password-security/">ã€Šç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 1ï¼šå¯†ç åŠ å¯†é‚£äº›äº‹å„¿ã€‹</a>ï¼‰ã€‚</p>
<p><strong>é—®é¢˜ 2ï¼šç™»å½•æ€ç®¡ç†</strong></p>
<p>æœ€å¼€å§‹ç”¨ Sessionï¼Œç»“æœåˆ·æ–°é¡µé¢å°±ä¸¢å¤±ï¼Œå¤šç«¯ä¹Ÿæ— æ³•å…±äº«ã€‚åæ¥æ”¹æˆ Redis + Token æ–¹æ¡ˆï¼Œè§£å†³äº†è¿™äº›é—®é¢˜ã€‚è¿™ä¸ªè¿‡ç¨‹æˆ‘ä¹Ÿå†™äº†æ–‡ç« ï¼ˆè§<a href="/2024/11/20/2024-11-20-login-session/">ã€Šç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 2ï¼šç™»å½•æ€ç®¡ç†çš„é‚£äº›å‘ã€‹</a>ï¼‰ã€‚</p>
<p><strong>é—®é¢˜ 3ï¼šè·¨åŸŸé—®é¢˜</strong></p>
<p>å‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œå‰ç«¯è¿è¡Œåœ¨ <code>localhost:3000</code>ï¼Œåç«¯è¿è¡Œåœ¨ <code>localhost:8080</code>ï¼Œæµè§ˆå™¨ä¼šæŠ¥è·¨åŸŸé”™è¯¯ã€‚æˆ‘é€šè¿‡é…ç½® CORS è§£å†³äº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CorsConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/api/**&quot;</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">&quot;http://localhost:3000&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é—®é¢˜ 4ï¼šæƒé™æ§åˆ¶</strong></p>
<p>æ™®é€šç”¨æˆ·å’Œç®¡ç†å‘˜èƒ½è®¿é—®çš„æ¥å£ä¸åŒï¼Œæˆ‘é€šè¿‡æ‹¦æˆªå™¨å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, </span></span><br><span class="line"><span class="params">                             HttpServletResponse response, </span></span><br><span class="line"><span class="params">                             Object handler)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. éªŒè¯ Token</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">        <span class="type">UserDTO</span> <span class="variable">user</span> <span class="operator">=</span> tokenUtils.verifyToken(token);</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;æœªç™»å½•&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æƒé™æ ¡éªŒï¼ˆç®¡ç†å‘˜æ¥å£éœ€è¦ admin è§’è‰²ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (request.getRequestURI().startsWith(<span class="string">&quot;/api/admin&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="string">&quot;admin&quot;</span>.equals(user.getUserRole())) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;æ— æƒé™&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ° ThreadLocal</span></span><br><span class="line">        UserContext.set(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-æµ‹è¯•ä¸ä¼˜åŒ–é˜¶æ®µ"><a href="#7-æµ‹è¯•ä¸ä¼˜åŒ–é˜¶æ®µ" class="headerlink" title="7. æµ‹è¯•ä¸ä¼˜åŒ–é˜¶æ®µ"></a>7. æµ‹è¯•ä¸ä¼˜åŒ–é˜¶æ®µ</h3><p><strong>å•å…ƒæµ‹è¯•</strong>ï¼š<br>è™½ç„¶æµ‹è¯•å†™å¾—ä¸å¤šï¼Œä½†è‡³å°‘ç»™æ ¸å¿ƒæ¥å£å†™äº†æµ‹è¯•ç”¨ä¾‹ï¼Œæ¯”å¦‚ç™»å½•ã€æ³¨å†Œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserControllerTest</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserController userController;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testLogin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">LoginRequest</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoginRequest</span>();</span><br><span class="line">        request.setAccount(<span class="string">&quot;test@example.com&quot;</span>);</span><br><span class="line">        request.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        Result&lt;LoginResponse&gt; result = userController.login(request);</span><br><span class="line">        assertEquals(<span class="number">0</span>, result.getCode());</span><br><span class="line">        assertNotNull(result.getData().getToken());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>ç»™ç”¨æˆ·è¡¨çš„é‚®ç®±ã€æ‰‹æœºå·å­—æ®µå»ºäº†ç´¢å¼•ï¼Œç™»å½•æŸ¥è¯¢å¿«äº†å¾ˆå¤š</li>
<li>ç™»å½•æˆåŠŸåæŠŠç”¨æˆ·ä¿¡æ¯å­˜åˆ° Redisï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢</li>
</ul>
<p><strong>å¼‚å¸¸å¤„ç†</strong>ï¼š<br>å†™äº†å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼Œç»Ÿä¸€å¤„ç†å¼‚å¸¸ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler(BusinessException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Void&gt; <span class="title function_">handleBusinessException</span><span class="params">(BusinessException e)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Void&gt; <span class="title function_">handleException</span><span class="params">(Exception e)</span> &#123;</span><br><span class="line">        log.error(<span class="string">&quot;ç³»ç»Ÿå¼‚å¸¸&quot;</span>, e);</span><br><span class="line">        <span class="keyword">return</span> Result.error(<span class="string">&quot;ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ ¸å¿ƒæŠ€æœ¯å®ç°"><a href="#æ ¸å¿ƒæŠ€æœ¯å®ç°" class="headerlink" title="æ ¸å¿ƒæŠ€æœ¯å®ç°"></a>æ ¸å¿ƒæŠ€æœ¯å®ç°</h2><h3 id="1-é€šç”¨è¿”å›ç»“æœå°è£…"><a href="#1-é€šç”¨è¿”å›ç»“æœå°è£…" class="headerlink" title="1. é€šç”¨è¿”å›ç»“æœå°è£…"></a>1. é€šç”¨è¿”å›ç»“æœå°è£…</h3><p>æ‰€æœ‰æ¥å£éƒ½è¿”å›ç»Ÿä¸€çš„ <code>Result&lt;T&gt;</code> æ ¼å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> code;        <span class="comment">// ä¸šåŠ¡çŠ¶æ€ç ï¼š0 è¡¨ç¤ºæˆåŠŸï¼Œé 0 è¡¨ç¤ºå¤±è´¥</span></span><br><span class="line">    <span class="keyword">private</span> T data;          <span class="comment">// æ•°æ®</span></span><br><span class="line">    <span class="keyword">private</span> String message;  <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æˆåŠŸè¿”å›</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">success</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        Result&lt;T&gt; result = <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;();</span><br><span class="line">        result.setCode(<span class="number">0</span>);</span><br><span class="line">        result.setData(data);</span><br><span class="line">        result.setMessage(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é”™è¯¯è¿”å›</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">error</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        Result&lt;T&gt; result = <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;();</span><br><span class="line">        result.setCode(<span class="number">500</span>);</span><br><span class="line">        result.setData(<span class="literal">null</span>);</span><br><span class="line">        result.setMessage(message);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-Token-å·¥å…·ç±»"><a href="#2-Token-å·¥å…·ç±»" class="headerlink" title="2. Token å·¥å…·ç±»"></a>2. Token å·¥å…·ç±»</h3><p>åŸºäº Redis çš„ Token ç®¡ç†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenUtils</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç”Ÿæˆ Token</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">generateToken</span><span class="params">(Long userId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;USER_TOKEN:&quot;</span> + UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å­˜å‚¨ Token å’Œç”¨æˆ·ä¿¡æ¯ï¼ˆ2å°æ—¶è¿‡æœŸï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">storeToken</span><span class="params">(String token, UserDTO user)</span> &#123;</span><br><span class="line">        redisTemplate.opsForValue().set(</span><br><span class="line">            token,</span><br><span class="line">            JSON.toJSONString(user),</span><br><span class="line">            <span class="number">2</span>,</span><br><span class="line">            TimeUnit.HOURS</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// éªŒè¯ Token å¹¶è‡ªåŠ¨ç»­æœŸ</span></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">verifyToken</span><span class="params">(String token)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userJson</span> <span class="operator">=</span> redisTemplate.opsForValue().get(token);</span><br><span class="line">        <span class="keyword">if</span> (userJson == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// éªŒè¯æˆåŠŸåè‡ªåŠ¨ç»­æœŸ</span></span><br><span class="line">        redisTemplate.expire(token, <span class="number">2</span>, TimeUnit.HOURS);</span><br><span class="line">        <span class="keyword">return</span> JSON.parseObject(userJson, UserDTO.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆThreadLocalï¼‰"><a href="#3-ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆThreadLocalï¼‰" class="headerlink" title="3. ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆThreadLocalï¼‰"></a>3. ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆThreadLocalï¼‰</h3><p>æ–¹ä¾¿åœ¨ Service å±‚è·å–å½“å‰ç™»å½•ç”¨æˆ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserContext</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;UserDTO&gt; userHolder = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(UserDTO user)</span> &#123;</span><br><span class="line">        userHolder.set(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> UserDTO <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userHolder.get();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        userHolder.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ”¶è·ä¸åæ€"><a href="#æ”¶è·ä¸åæ€" class="headerlink" title="æ”¶è·ä¸åæ€"></a>æ”¶è·ä¸åæ€</h2><h3 id="å­¦åˆ°çš„æŠ€æœ¯"><a href="#å­¦åˆ°çš„æŠ€æœ¯" class="headerlink" title="å­¦åˆ°çš„æŠ€æœ¯"></a>å­¦åˆ°çš„æŠ€æœ¯</h3><ol>
<li><strong>Spring Boot æ ¸å¿ƒåŠŸèƒ½</strong>ï¼šæ³¨è§£ã€é…ç½®ã€æ‹¦æˆªå™¨ã€å¼‚å¸¸å¤„ç†</li>
<li><strong>MyBatis-Plus</strong>ï¼šç®€åŒ–æ•°æ®åº“æ“ä½œï¼Œè‡ªåŠ¨ç”Ÿæˆä»£ç </li>
<li><strong>Redis</strong>ï¼šç¼“å­˜ã€Token å­˜å‚¨ã€åˆ†å¸ƒå¼æ”¯æŒ</li>
<li><strong>å‰åç«¯åˆ†ç¦»å¼€å‘</strong>ï¼šæ¥å£è®¾è®¡ã€è·¨åŸŸå¤„ç†ã€Token ä¼ é€’</li>
<li><strong>æ•°æ®åº“è®¾è®¡</strong>ï¼šè¡¨ç»“æ„è®¾è®¡ã€ç´¢å¼•ä¼˜åŒ–ã€é€»è¾‘åˆ é™¤</li>
</ol>
<h3 id="ä¸è¶³ä¸æ”¹è¿›"><a href="#ä¸è¶³ä¸æ”¹è¿›" class="headerlink" title="ä¸è¶³ä¸æ”¹è¿›"></a>ä¸è¶³ä¸æ”¹è¿›</h3><ol>
<li><strong>æµ‹è¯•è¦†ç›–ä¸å¤Ÿ</strong>ï¼šåªå†™äº†æ ¸å¿ƒæ¥å£çš„æµ‹è¯•ï¼Œè¾¹ç•Œæƒ…å†µè€ƒè™‘ä¸å…¨</li>
<li><strong>ä»£ç å¤ç”¨æ€§</strong>ï¼šéƒ¨åˆ†é€»è¾‘å­˜åœ¨å†—ä½™ï¼Œå¯ä»¥æå–æˆå…¬å…±æ–¹æ³•</li>
<li><strong>æ¥å£é™æµ</strong>ï¼šæ²¡æœ‰å®ç°é™æµï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½å‡ºé—®é¢˜</li>
<li><strong>æ—¥å¿—è®°å½•</strong>ï¼šæ—¥å¿—è®°å½•ä¸å¤Ÿå®Œå–„ï¼Œå‡ºé—®é¢˜æ—¶æ’æŸ¥å›°éš¾</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šè™½ç„¶ç”¨äº† BCrypt å’Œ Tokenï¼Œä½†è¿˜æœ‰å¾ˆå¤šå®‰å…¨æªæ–½æ²¡åšï¼ˆæ¯”å¦‚æ¥å£é™æµã€é˜² SQL æ³¨å…¥ç­‰ï¼‰</li>
</ol>
<h3 id="åç»­è®¡åˆ’"><a href="#åç»­è®¡åˆ’" class="headerlink" title="åç»­è®¡åˆ’"></a>åç»­è®¡åˆ’</h3><p>è™½ç„¶é¡¹ç›®åŸºæœ¬åŠŸèƒ½éƒ½å®ç°äº†ï¼Œä½†è¿˜æœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼š</p>
<ol>
<li><p><strong>åŠŸèƒ½æ‰©å±•</strong>ï¼š</p>
<ul>
<li>æ¥å…¥çŸ­ä¿¡éªŒè¯ç ï¼Œå¢å¼ºæ³¨å†Œå®‰å…¨æ€§</li>
<li>å®ç°ç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½</li>
<li>æ·»åŠ ç”¨æˆ·ç™»å½•æ—¥å¿—ï¼Œæ–¹ä¾¿åˆ†æå¼‚å¸¸ç™»å½•</li>
</ul>
</li>
<li><p><strong>æŠ€æœ¯æå‡</strong>ï¼š</p>
<ul>
<li>å­¦ä¹  Dockerï¼ŒæŠŠé¡¹ç›®å®¹å™¨åŒ–</li>
<li>å­¦ä¹  Nginxï¼Œåšåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡</li>
<li>æŠŠé¡¹ç›®éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ï¼Œè®©å…¶ä»–äººä¹Ÿèƒ½è®¿é—®</li>
</ul>
</li>
<li><p><strong>ä»£ç ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>æé«˜æµ‹è¯•è¦†ç›–ç‡</li>
<li>ä¼˜åŒ–ä»£ç ç»“æ„ï¼Œæé«˜å¤ç”¨æ€§</li>
<li>æ¥å…¥æ¥å£é™æµï¼Œé˜²æ­¢æ¶æ„è¯·æ±‚</li>
</ul>
</li>
</ol>
<h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>ä½œä¸ºç¬¬ä¸€ä¸ªå®Œæ•´é¡¹ç›®ï¼Œè¿‡ç¨‹è™½ç„¶ç£•ç£•ç»Šç»Šï¼Œä½†æ”¶è·è¿œè¶…é¢„æœŸã€‚ä»æœ€åˆè¿æ•°æ®åº“è¿æ¥éƒ½é…ç½®ä¸å¥½ï¼Œåˆ°ç°åœ¨èƒ½ç‹¬ç«‹è§£å†³åŠ å¯†ã€ç™»å½•æ€ã€è·¨åŸŸç­‰é—®é¢˜ï¼ŒçœŸåˆ‡æ„Ÿå—åˆ°äº†â€å®è·µâ€çš„åŠ›é‡ã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®è®©æˆ‘æ˜ç™½ï¼Œ<strong>ç†è®ºå¾ˆé‡è¦ï¼Œä½†å®è·µæ›´å…³é”®</strong>ã€‚çœ‹å†å¤šæ•™ç¨‹ï¼Œä¸å¦‚è‡ªå·±åŠ¨æ‰‹åšä¸€éã€‚é‡åˆ°é—®é¢˜ã€è§£å†³é—®é¢˜ã€æ€»ç»“ç»éªŒï¼Œè¿™ä¸ªè¿‡ç¨‹è®©æˆ‘æˆé•¿äº†å¾ˆå¤šã€‚</p>
<p>è™½ç„¶é¡¹ç›®è¿˜æ²¡éƒ¨ç½²ï¼Œä»£ç ä¹Ÿè¿˜æœ‰å¾ˆå¤šå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œä½†è‡³å°‘æˆ‘è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ã€‚è·¯è¿˜å¾ˆé•¿ï¼Œç»§ç»­åŠ æ²¹ï¼</p>
<hr>
<h2 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h2><p>è¿™ä¸ªç”¨æˆ·ä¸­å¿ƒé¡¹ç›®ç³»åˆ—çš„å…¶ä»–æ–‡ç« ï¼š</p>
<ul>
<li><a href="/2024/11/15/2024-11-15-password-security/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 1ï¼šå¯†ç åŠ å¯†é‚£äº›äº‹å„¿</a></li>
<li><a href="/2024/11/20/2024-11-20-login-session/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®è¸©å‘è®° 2ï¼šç™»å½•æ€ç®¡ç†çš„é‚£äº›å‘</a></li>
<li><a href="/2024/11/26/2024-11-26-user-center-database-design/">ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®çš„æ•°æ®åº“è®¾è®¡ï¼šå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
</ul>
]]></content>
      <categories>
        <category>åç«¯å¼€å‘æ€è€ƒ</category>
      </categories>
      <tags>
        <tag>åç«¯å¼€å‘</tag>
        <tag>Spring Boot</tag>
        <tag>ç”¨æˆ·ä¸­å¿ƒ</tag>
      </tags>
  </entry>
</search>
